import{D as k}from"./DataTable-B3587RkR.js";import{_,h as P,w as d,e as a,f as p,r as i,a as n,g as I,o as g,I as w,t as O,c as y,F as B}from"./index-BEa9HEip.js";import{h as M,F as D,c as A,a as E}from"./http-1tLpSZt0.js";import{t as S,M as v}from"./ModalBase-CaLbg0J6.js";import{M as F}from"./MyButton-DrhqSgDt.js";const x=o=>M.authApi().post("/position",o),T=o=>M.authApi().get(`/position?${S(o)}`),b=(o,t)=>M.authApi().put(`/position/${o}`,t),N=o=>M.authApi().delete(`/position/${o}`),V={name:"FormPositionModal",components:{ModalBase:v,FormInput:D,MyButton:F},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onSave"],data(){return{form:{status:!1},errors:{},loading:!1}},watch:{dataForm(){this.dataForm&&(this.form={...this.form,...this.dataForm})}},methods:{validate(){A({name:E().required("Cargo é obrigatório")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.savePosition()}).catch(t=>{const l={};t.inner.forEach(h=>{l[h.path]=h.message}),this.errors=l})},async savePosition(){this.loading=!0;try{const o=!!this.form.id;o&&(delete this.form.id,delete this.form.createdAt,delete this.form.updatedAt,delete this.form.deletedAt),o?await b(this.dataForm.id,this.form):await x(this.form),this.$snotify.success(`Cargo ${o?"atualizado":"criado"} com sucesso`),this.$emit("onSave"),this.closeModal()}catch(o){this.$snotify.error("Erro ao salvar o cargo: "+o)}finally{this.loading=!1}},closeModal(){this.form={status:!1},this.errors={},this.$emit("onClose")}}};function $(o,t,l,h,e,s){const r=i("FormInput"),u=i("MyButton"),f=i("ModalBase");return g(),P(f,{open:l.show,loading:e.loading,title:"Novo Cargo",onOnClose:s.closeModal},{content:d(()=>[n("form",{onSubmit:t[1]||(t[1]=I((...c)=>s.validate&&s.validate(...c),["prevent"]))},[a(r,{label:"Cargo",type:"text",placeholder:"Digite o cargo",modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=c=>e.form.name=c),error:e.errors.name,required:""},null,8,["modelValue","error"])],32)]),actions:d(()=>[a(u,{class:"btn success",loading:e.loading,onClick:s.validate},{default:d(()=>t[2]||(t[2]=[p(" Salvar ")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading","onOnClose"])}const q=_(V,[["render",$],["__scopeId","data-v-ae27cfa0"]]),z={name:"DeletePositionModal",components:{ModalBase:v,Icon:w,MyButton:F},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onConfirm"],data(){return{loading:!1}},methods:{async deletePosition(){this.loading=!0;try{await N(this.dataForm.id),this.$snotify.success("Cargo excluído com sucesso!"),this.$emit("onConfirm"),this.$emit("onClose")}catch(o){this.$snotify.error("Erro ao excluir o cargo: "+o)}finally{this.loading=!1}}}};function L(o,t,l,h,e,s){const r=i("Icon"),u=i("MyButton"),f=i("ModalBase");return g(),P(f,{open:l.show,loading:e.loading,title:"Confirmar Exclusão",onOnClose:t[0]||(t[0]=c=>o.$emit("onClose"))},{content:d(()=>[n("section",null,[a(r,{icon:"carbon:warning"}),n("div",null,[n("p",null,[t[1]||(t[1]=p(" Tem certeza que deseja excluir o cargo ")),n("span",null,O(l.dataForm?.name),1),t[2]||(t[2]=p(" ? "))]),t[3]||(t[3]=n("p",null,"Essa ação não pode ser desfeita!",-1))])])]),actions:d(()=>[a(u,{class:"btn danger",loading:e.loading,onClick:s.deletePosition},{default:d(()=>t[4]||(t[4]=[p("Confirmar")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading"])}const j=_(z,[["render",L],["__scopeId","data-v-5b13b7af"]]),Q={name:"RecruiterPosition",components:{DataTable:k,Icon:w,FormPositionModal:q,DeletePositionModal:j},data(){return{showFormPositionModal:!1,showDeletePositionModal:!1,loading:!1,columns:[{key:"name",title:"Nome"},{key:"status",title:"Status",type:"boolean"},{key:"createdAt",title:"Criado em",type:"date"}],items:[],editItem:{},total:0,page:1,search:""}},mounted(){this.getPositions()},methods:{refresh(){this.items=[],this.getPositions()},async getPositions(){this.closeAllModals(),this.loading=!0;try{const o=await T(this.filters);this.items.push(...o.data),this.total=o.data.total}catch(o){this.$snotify.error("Erro ao buscar os cargos: "+o)}finally{this.loading=!1}},async handleTogglePosition(o){this.loading=!0;try{o.status=!o.status,await b(o.id,{status:o.status}),this.$snotify.success("Cargo atualizado com sucesso!")}catch(t){this.$snotify.error("Erro ao atualizar o cargo: "+t),o.status=!o.status}finally{this.loading=!1}},handleSearch(o){this.search=o,this.page=1,this.items=[],this.getPositions()},handleNewPosition(){this.editItem={},this.showFormPositionModal=!0},handleEditPosition(o){this.editItem=o,this.showFormPositionModal=!0},handleConfirmDelete(o){this.editItem=o,this.showDeletePositionModal=!0},closeAllModals(){this.editItem={},this.showFormPositionModal=!1,this.showDeletePositionModal=!1},handleLoadMore(){this.page+=1,this.getPositions()}},computed:{filters(){return{page:this.page,filter:this.search}},loadMore(){return this.items.length<this.total}}},R={class:"card"},U=["onClick"],G=["onClick"],H=["onClick"],J=["onClick"];function K(o,t,l,h,e,s){const r=i("Icon"),u=i("DataTable"),f=i("FormPositionModal"),c=i("DeletePositionModal");return g(),y(B,null,[n("main",null,[n("section",R,[n("header",null,[t[1]||(t[1]=n("h1",null,"Cargos",-1)),n("button",{class:"rounded",onClick:t[0]||(t[0]=m=>e.showFormPositionModal=!0),title:"Novo Cargo"},[a(r,{icon:"qlementine-icons:new-16"})])]),a(u,{items:e.items,columns:e.columns,loading:e.loading,total:e.total,loadMore:s.loadMore,onOnLoadMore:s.handleLoadMore,onOnSearch:s.handleSearch},{actions:d(({item:m})=>[m.status?(g(),y("button",{key:0,class:"rounded warning",onClick:C=>s.handleTogglePosition(m),title:"Pausar"},[a(r,{icon:"ic:round-pause"})],8,U)):(g(),y("button",{key:1,class:"rounded primary",onClick:C=>s.handleTogglePosition(m),title:"Ativar"},[a(r,{icon:"ic:round-play-arrow"})],8,G)),n("button",{class:"rounded success",onClick:C=>s.handleEditPosition(m)},[a(r,{icon:"carbon:edit"})],8,H),n("button",{class:"rounded danger",onClick:C=>s.handleConfirmDelete(m)},[a(r,{icon:"carbon:trash-can"})],8,J)]),_:1},8,["items","columns","loading","total","loadMore","onOnLoadMore","onOnSearch"])])]),a(f,{show:e.showFormPositionModal,dataForm:e.editItem,onOnClose:s.closeAllModals,onOnSave:s.refresh},null,8,["show","dataForm","onOnClose","onOnSave"]),a(c,{show:e.showDeletePositionModal,dataForm:e.editItem,onOnClose:s.closeAllModals,onOnConfirm:s.refresh},null,8,["show","dataForm","onOnClose","onOnConfirm"])],64)}const to=_(Q,[["render",K],["__scopeId","data-v-b2f93fa6"]]);export{to as default};
