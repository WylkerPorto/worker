import{F as V,c as F,a as f}from"./FormInput-BaMJFtPI.js";import{M as C}from"./MyButton-zRUcqBi7.js";import{c as I}from"./user-oUq1n9dn.js";import{_ as y,c as b,a,e as i,r as d,w,f as h,g,o as c,t as k,h as v,b as E}from"./index-H3lZLf22.js";import{M as A}from"./SwitchButton-DMl2mpEq.js";import{h as S}from"./http-PEIwzPbB.js";const x={name:"RegisterCard",components:{FormInput:V,MyButton:C},props:{dataForm:{type:Object}},data(){return{form:{},localForm:this.dataForm,errors:{},loading:!1}},methods:{validate(){F({name:f().min(3,"Nome deve ter pelo menos 3 caracteres").required("Nome é obrigatório"),email:f().email("E-mail inválido").required("E-mail é obrigatório"),password:f().min(6,"Senha deve ter pelo menos 6 caracteres").required("Senha é obrigatória"),phoneNumber:f().matches(/^\(\d{2}\)\s\d{4,5}-\d{4}$/,"Telefone deve estar no formato (12) 12345-1234").required("Telefone é obrigatório")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.registerAccount()}).catch(e=>{const s={};e.inner.forEach(n=>{s[n.path]=n.message}),this.errors=s})},async registerAccount(){this.loading=!0;try{await I(this.form),this.$snotify.success("Cadastro realizado com sucesso!"),this.localForm.type="login"}catch(o){this.$snotify.error("Erro ao cadastrar: "+o.message)}finally{this.loading=!1}}}};function M(o,e,s,n,r,u){const l=d("FormInput"),p=d("MyButton");return c(),b("form",{class:"card",onSubmit:e[5]||(e[5]=g((...t)=>u.validate&&u.validate(...t),["stop","prevent"]))},[e[8]||(e[8]=a("h2",null,"Criar conta",-1)),i(l,{label:"Nome",modelValue:r.form.name,"onUpdate:modelValue":e[0]||(e[0]=t=>r.form.name=t),error:r.errors.name,type:"text",placeholder:"Digite seu nome"},null,8,["modelValue","error"]),i(l,{label:"E-mail",modelValue:r.form.email,"onUpdate:modelValue":e[1]||(e[1]=t=>r.form.email=t),error:r.errors.email,type:"email",placeholder:"Digite seu e-mail"},null,8,["modelValue","error"]),i(l,{label:"Senha",modelValue:r.form.password,"onUpdate:modelValue":e[2]||(e[2]=t=>r.form.password=t),error:r.errors.password,type:"password",placeholder:"Digite sua senha"},null,8,["modelValue","error"]),i(l,{label:"Telefone",modelValue:r.form.phoneNumber,"onUpdate:modelValue":e[3]||(e[3]=t=>r.form.phoneNumber=t),error:r.errors.phoneNumber,type:"tel",placeholder:"(99) 99999-9999",mask:"tel"},null,8,["modelValue","error"]),i(p,{class:"primary",loading:r.loading},{default:w(()=>e[6]||(e[6]=[h("Cadastrar")])),_:1},8,["loading"]),e[9]||(e[9]=a("hr",null,null,-1)),a("span",null,[e[7]||(e[7]=h(" Já é cadastrado? ")),a("a",{href:"#",onClick:e[4]||(e[4]=g(t=>r.localForm.type="login",["prevent"]))},"Entrar")])],32)}const D=y(x,[["render",M],["__scopeId","data-v-6697a36d"]]),B=o=>S.api().post("/auth/login",o),N=o=>S.api().post("/auth/login-candidate",o),R=o=>S.api().post("/login/remember",o),q={name:"LoginCard",components:{FormInput:V,MyButton:C,MySwitch:A},props:{dataForm:{type:Object}},data(){return{form:{},localForm:this.dataForm,errors:{},loading:!1,admin:!1}},methods:{validate(){F({email:f().email("E-mail inválido").required("E-mail é obrigatório"),password:f().min(6,"Senha deve ter pelo menos 6 caracteres").required("Senha é obrigatória")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.loginAccount()}).catch(e=>{const s={};e.inner.forEach(n=>{s[n.path]=n.message}),this.errors=s})},async loginAccount(){this.loading=!0;try{const o=await(this.admin?B(this.form):N(this.form));this.setAuth(o.data.access_token,o.data.permission,o.data.uid)}catch(o){o.response.status===401?this.$snotify.error("E-mail ou senha inválidos"):o.response.status===403?this.$snotify.error("Acesso negado"):this.$snotify.error("Erro ao logar: "+o.message)}finally{this.loading=!1}},setAuth(o,e,s){localStorage.setItem("login","true"),localStorage.setItem("token",o),localStorage.setItem("role",e),localStorage.setItem("uid",s.toString()),this.sendToDashboard(e)},sendToDashboard(o){switch(o){case 1:this.$router.push({name:"adminDashboard"});return;case 2:this.$router.push({name:"supervisorDashboard"});return;case 3:this.$router.push({name:"recruiterDashboard"});return;case 4:this.$router.push({name:"userAplication"});return;default:this.$snotify.error("Erro ao logar: Regra invalida");return}}}},U={class:"flex"};function L(o,e,s,n,r,u){const l=d("FormInput"),p=d("MySwitch"),t=d("MyButton");return c(),b("form",{class:"card",onSubmit:e[6]||(e[6]=g((...m)=>u.validate&&u.validate(...m),["stop","prevent"]))},[e[9]||(e[9]=a("h2",null,"Login",-1)),i(l,{label:"E-mail",modelValue:r.form.email,"onUpdate:modelValue":e[0]||(e[0]=m=>r.form.email=m),error:r.errors.email,type:"email",placeholder:"Digite seu e-mail"},null,8,["modelValue","error"]),i(l,{label:"Senha",modelValue:r.form.password,"onUpdate:modelValue":e[1]||(e[1]=m=>r.form.password=m),error:r.errors.password,type:"password",placeholder:"Digite sua senha"},null,8,["modelValue","error"]),a("div",U,[i(p,{modelValue:r.admin,"onUpdate:modelValue":e[2]||(e[2]=m=>r.admin=m)},null,8,["modelValue"]),a("span",{onClick:e[3]||(e[3]=m=>r.admin=!r.admin)},k(r.admin?"Empresa":"Candidato"),1)]),a("a",{href:"#",onClick:e[4]||(e[4]=g(m=>r.localForm.type="forgot-password",["prevent"]))},"Esqueci minha senha"),i(t,{class:"primary",loading:r.loading},{default:w(()=>e[7]||(e[7]=[h("Entrar")])),_:1},8,["loading"]),e[10]||(e[10]=a("hr",null,null,-1)),a("span",null,[e[8]||(e[8]=h(" Ainda não tem conta? ")),a("a",{href:"#",onClick:e[5]||(e[5]=g(m=>r.localForm.type="register",["prevent"]))},"Cadastre-se")])],32)}const T=y(q,[["render",L],["__scopeId","data-v-8f0d2756"]]),_={name:"RememberCard",components:{FormInput:V,MyButton:C},props:{dataForm:{type:Object}},data(){return{form:{},localForm:this.dataForm,errors:{},loading:!1}},methods:{validate(){F({email:f().email("E-mail inválido").required("E-mail é obrigatório")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.rememberAccount()}).catch(e=>{const s={};e.inner.forEach(n=>{s[n.path]=n.message}),this.errors=s})},async rememberAccount(){this.loading=!0;try{await R(this.form)}catch(o){this.$snotify.error("Erro ao recuperar senha: "+o.message)}finally{this.loading=!1}}}};function j(o,e,s,n,r,u){const l=d("FormInput"),p=d("MyButton");return c(),b("form",{class:"card",onSubmit:e[2]||(e[2]=g((...t)=>u.validate&&u.validate(...t),["stop","prevent"]))},[e[5]||(e[5]=a("h2",null,"Recuperar Senha",-1)),i(l,{label:"E-mail",modelValue:r.form.email,"onUpdate:modelValue":e[0]||(e[0]=t=>r.form.email=t),error:r.errors.email,type:"email",placeholder:"Digite seu e-mail"},null,8,["modelValue","error"]),i(p,{class:"primary",loading:r.loading},{default:w(()=>e[3]||(e[3]=[h("Recuperar")])),_:1},8,["loading"]),e[6]||(e[6]=a("hr",null,null,-1)),a("span",null,[e[4]||(e[4]=h(" Lembrou sua senha? ")),a("a",{href:"#",onClick:e[1]||(e[1]=g(t=>r.localForm.type="login",["prevent"]))},"Entrar")])],32)}const O=y(_,[["render",j],["__scopeId","data-v-bdd2fe94"]]),z={name:"LoginView",components:{LoginCard:T,RegisterCard:D,RememberCard:O},data(){return{form:{type:"login"}}},methods:{}};function J(o,e,s,n,r,u){const l=d("LoginCard"),p=d("RegisterCard"),t=d("RememberCard");return c(),b("main",null,[r.form.type==="login"?(c(),v(l,{key:0,dataForm:r.form},null,8,["dataForm"])):E("",!0),r.form.type==="register"?(c(),v(p,{key:1,dataForm:r.form},null,8,["dataForm"])):E("",!0),r.form.type==="forgot-password"?(c(),v(t,{key:2,dataForm:r.form},null,8,["dataForm"])):E("",!0)])}const X=y(z,[["render",J],["__scopeId","data-v-61a27157"]]);export{X as default};
