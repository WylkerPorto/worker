import{D as F}from"./DataTable-DZolE3ng.js";import{_ as D,g,w as d,e as a,f as p,r,a as n,h as v,o as M,I as w,t as S,c as I,F as b}from"./index-Mu0760Vm.js";import{F as B,c as k,a as O}from"./FormInput-vldQscfs.js";import{M as _}from"./ModalBase-Bwp8s5BC.js";import{M as C}from"./MyButton-CAWIgk02.js";import{M as x}from"./SwitchButton-Dcz87ajI.js";import{u as E,c as V,r as A,l as N}from"./department-sP2gsjK2.js";import"./SearchInput-B9aETNtM.js";import"./conversors-CKfFtFQ4.js";import"./http-CXuHNYXv.js";const T={name:"FormDepartmentModal",components:{ModalBase:_,FormInput:B,MyButton:C,SwitchButton:x},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onSave"],data(){return{form:{status:!0},errors:{},loading:!1}},watch:{dataForm(){this.dataForm&&(this.form={...this.form,...this.dataForm})}},methods:{validate(){k({name:O().required("Setor é obrigatório")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.saveDepartment()}).catch(e=>{const i={};e.inner.forEach(c=>{i[c.path]=c.message}),this.errors=i})},async saveDepartment(){this.loading=!0;try{const t=!!this.form.id;t?(delete this.form.id,delete this.form.createdAt,delete this.form.updatedAt,delete this.form.deletedAt,await E(this.dataForm.id,this.form)):await V(this.form),this.$snotify.success(`Setor ${t?"atualizado":"criado"} com sucesso`),this.$emit("onSave"),this.closeModal()}catch(t){this.$snotify.error("Erro ao salvar o setor: "+t)}finally{this.loading=!1}},closeModal(){this.form={status:!0},this.errors={},this.$emit("onClose")}}};function q(t,e,i,c,o,s){const m=r("FormInput"),u=r("SwitchButton"),h=r("MyButton"),f=r("ModalBase");return M(),g(f,{open:i.show,loading:o.loading,title:"Novo Setor",onOnClose:s.closeModal},{content:d(()=>[n("form",{onSubmit:e[2]||(e[2]=v((...l)=>s.validate&&s.validate(...l),["prevent"]))},[a(m,{label:"Setor",type:"text",placeholder:"Digite o setor",modelValue:o.form.name,"onUpdate:modelValue":e[0]||(e[0]=l=>o.form.name=l),error:o.errors.name,required:""},null,8,["modelValue","error"]),n("div",null,[e[3]||(e[3]=n("label",null,"Status",-1)),a(u,{modelValue:o.form.status,"onUpdate:modelValue":e[1]||(e[1]=l=>o.form.status=l)},null,8,["modelValue"])])],32)]),actions:d(()=>[a(h,{class:"btn success",loading:o.loading,onClick:s.validate},{default:d(()=>e[4]||(e[4]=[p(" Salvar ")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading","onOnClose"])}const j=D(T,[["render",q],["__scopeId","data-v-7d6f26f5"]]),z={name:"DeleteDepartmentModal",components:{ModalBase:_,Icon:w,MyButton:C},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onConfirm"],data(){return{loading:!1}},methods:{async deleteDepartment(){this.loading=!0;try{await A(this.dataForm.id),this.$snotify.success("Setor excluído com sucesso!"),this.$emit("onConfirm"),this.$emit("onClose")}catch(t){this.$snotify.error("Erro ao excluir o setor: "+t)}finally{this.loading=!1}}}};function L(t,e,i,c,o,s){const m=r("Icon"),u=r("MyButton"),h=r("ModalBase");return M(),g(h,{open:i.show,loading:o.loading,title:"Confirmar Exclusão",onOnClose:e[0]||(e[0]=f=>t.$emit("onClose"))},{content:d(()=>[n("section",null,[a(m,{icon:"carbon:warning"}),n("div",null,[n("p",null,[e[1]||(e[1]=p(" Tem certeza que deseja excluir o setor ")),n("span",null,S(i.dataForm?.name),1),e[2]||(e[2]=p(" ? "))]),e[3]||(e[3]=n("p",null,"Essa ação não pode ser desfeita!",-1))])])]),actions:d(()=>[a(u,{class:"btn danger",loading:o.loading,onClick:s.deleteDepartment},{default:d(()=>e[4]||(e[4]=[p("Confirmar")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading"])}const U=D(z,[["render",L],["__scopeId","data-v-fa4fd001"]]),R={name:"RecruiterDepartment",components:{DataTable:F,Icon:w,FormDepartmentModal:j,DeleteDepartmentModal:U},data(){return{showFormDepartmentModal:!1,showDeleteDepartmentModal:!1,loading:!1,columns:[{key:"name",title:"Nome"},{key:"status",title:"Status",type:"boolean"},{key:"createdAt",title:"Criado em",type:"date"}],items:[],editItem:{},total:0,search:""}},mounted(){this.getDepartments()},methods:{refresh(){this.items=[],this.getDepartments()},async getDepartments(){this.closeAllModals(),this.loading=!0;try{const{data:t}=await N(this.filters);this.items=t,this.total=t.length}catch(t){this.$snotify.error("Erro ao buscar os setor: "+t)}finally{this.loading=!1}},handleSearch(t){this.search=t},handleNewDepartment(){this.editItem={},this.showFormDepartmentModal=!0},handleEditDepartment(t){this.editItem=t,this.showFormDepartmentModal=!0},handleConfirmDelete(t){this.editItem=t,this.showDeleteDepartmentModal=!0},closeAllModals(){this.editItem={},this.showFormDepartmentModal=!1,this.showDeleteDepartmentModal=!1}},computed:{filteredItems(){return this.items.filter(t=>t.name.toLowerCase().includes(this.search.toLowerCase()))}}},G={class:"card"},H=["onClick"],J=["onClick"];function K(t,e,i,c,o,s){const m=r("Icon"),u=r("DataTable"),h=r("FormDepartmentModal"),f=r("DeleteDepartmentModal");return M(),I(b,null,[n("main",null,[n("section",G,[n("header",null,[e[1]||(e[1]=n("h1",null,"Setores",-1)),n("button",{class:"rounded",onClick:e[0]||(e[0]=l=>o.showFormDepartmentModal=!0),title:"Novo Setor"},[a(m,{icon:"qlementine-icons:new-16"})])]),a(u,{items:s.filteredItems,columns:o.columns,loading:o.loading,totalItems:o.total,onOnSearch:s.handleSearch},{actions:d(({item:l})=>[n("button",{class:"rounded success",onClick:y=>s.handleEditDepartment(l)},[a(m,{icon:"carbon:edit"})],8,H),n("button",{class:"rounded danger",onClick:y=>s.handleConfirmDelete(l)},[a(m,{icon:"carbon:trash-can"})],8,J)]),_:1},8,["items","columns","loading","totalItems","onOnSearch"])])]),a(h,{show:o.showFormDepartmentModal,dataForm:o.editItem,onOnClose:s.closeAllModals,onOnSave:s.refresh},null,8,["show","dataForm","onOnClose","onOnSave"]),a(f,{show:o.showDeleteDepartmentModal,dataForm:o.editItem,onOnClose:s.closeAllModals,onOnConfirm:s.refresh},null,8,["show","dataForm","onOnClose","onOnConfirm"])],64)}const se=D(R,[["render",K],["__scopeId","data-v-0ead4d61"]]);export{se as default};
