import{D as F}from"./DataTable-DZolE3ng.js";import{_ as g,g as M,w as m,e as a,f as p,r as i,a as n,h as v,o as C,I as w,t as I,c as b,F as B}from"./index-Mu0760Vm.js";import{F as S,c as D,a as k}from"./FormInput-vldQscfs.js";import{M as _}from"./ModalBase-Bwp8s5BC.js";import{M as y}from"./MyButton-CAWIgk02.js";import{M as O}from"./SwitchButton-Dcz87ajI.js";import{u as x,c as E,r as V,l as A}from"./position-2dbD_-kw.js";import"./SearchInput-B9aETNtM.js";import"./conversors-CKfFtFQ4.js";import"./http-CXuHNYXv.js";const N={name:"FormPositionModal",components:{ModalBase:_,FormInput:S,MyButton:y,SwitchButton:O},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onSave"],data(){return{form:{status:!0},errors:{},loading:!1}},watch:{dataForm(){this.dataForm&&(this.form={...this.form,...this.dataForm})}},methods:{validate(){D({name:k().required("Cargo é obrigatório")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.savePosition()}).catch(o=>{const r={};o.inner.forEach(c=>{r[c.path]=c.message}),this.errors=r})},async savePosition(){this.loading=!0;try{const t=!!this.form.id;t&&(delete this.form.id,delete this.form.createdAt,delete this.form.updatedAt,delete this.form.deletedAt),t?await x(this.dataForm.id,this.form):await E(this.form),this.$snotify.success(`Cargo ${t?"atualizado":"criado"} com sucesso`),this.$emit("onSave"),this.closeModal()}catch(t){this.$snotify.error("Erro ao salvar o cargo: "+t)}finally{this.loading=!1}},closeModal(){this.form={status:!0},this.errors={},this.$emit("onClose")}}};function T(t,o,r,c,e,s){const d=i("FormInput"),u=i("SwitchButton"),h=i("MyButton"),f=i("ModalBase");return C(),M(f,{open:r.show,loading:e.loading,title:"Novo Cargo",onOnClose:s.closeModal},{content:m(()=>[n("form",{onSubmit:o[2]||(o[2]=v((...l)=>s.validate&&s.validate(...l),["prevent"]))},[a(d,{label:"Cargo",type:"text",placeholder:"Digite o cargo",modelValue:e.form.name,"onUpdate:modelValue":o[0]||(o[0]=l=>e.form.name=l),error:e.errors.name,required:""},null,8,["modelValue","error"]),n("div",null,[o[3]||(o[3]=n("label",null,"Status",-1)),a(u,{modelValue:e.form.status,"onUpdate:modelValue":o[1]||(o[1]=l=>e.form.status=l)},null,8,["modelValue"])])],32)]),actions:m(()=>[a(h,{class:"btn success",loading:e.loading,onClick:s.validate},{default:m(()=>o[4]||(o[4]=[p(" Salvar ")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading","onOnClose"])}const q=g(N,[["render",T],["__scopeId","data-v-d8731805"]]),j={name:"DeletePositionModal",components:{ModalBase:_,Icon:w,MyButton:y},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onConfirm"],data(){return{loading:!1}},methods:{async deletePosition(){this.loading=!0;try{await V(this.dataForm.id),this.$snotify.success("Cargo excluído com sucesso!"),this.$emit("onConfirm"),this.$emit("onClose")}catch(t){this.$snotify.error("Erro ao excluir o cargo: "+t)}finally{this.loading=!1}}}};function z(t,o,r,c,e,s){const d=i("Icon"),u=i("MyButton"),h=i("ModalBase");return C(),M(h,{open:r.show,loading:e.loading,title:"Confirmar Exclusão",onOnClose:o[0]||(o[0]=f=>t.$emit("onClose"))},{content:m(()=>[n("section",null,[a(d,{icon:"carbon:warning"}),n("div",null,[n("p",null,[o[1]||(o[1]=p(" Tem certeza que deseja excluir o cargo ")),n("span",null,I(r.dataForm?.name),1),o[2]||(o[2]=p(" ? "))]),o[3]||(o[3]=n("p",null,"Essa ação não pode ser desfeita!",-1))])])]),actions:m(()=>[a(u,{class:"btn danger",loading:e.loading,onClick:s.deletePosition},{default:m(()=>o[4]||(o[4]=[p("Confirmar")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading"])}const L=g(j,[["render",z],["__scopeId","data-v-5b13b7af"]]),U={name:"RecruiterPosition",components:{DataTable:F,Icon:w,FormPositionModal:q,DeletePositionModal:L},data(){return{showFormPositionModal:!1,showDeletePositionModal:!1,loading:!1,columns:[{key:"name",title:"Nome"},{key:"status",title:"Status",type:"boolean"},{key:"createdAt",title:"Criado em",type:"date"}],items:[],editItem:{},total:0,search:""}},mounted(){this.getPositions()},methods:{refresh(){this.items=[],this.getPositions()},async getPositions(){this.closeAllModals(),this.loading=!0;try{const{data:t}=await A();this.items=t,this.total=t.length}catch(t){this.$snotify.error("Erro ao buscar os cargos: "+t)}finally{this.loading=!1}},handleSearch(t){this.search=t},handleNewPosition(){this.editItem={},this.showFormPositionModal=!0},handleEditPosition(t){this.editItem=t,this.showFormPositionModal=!0},handleConfirmDelete(t){this.editItem=t,this.showDeletePositionModal=!0},closeAllModals(){this.editItem={},this.showFormPositionModal=!1,this.showDeletePositionModal=!1}},computed:{filteredItems(){return this.items.filter(t=>t.name.toLowerCase().includes(this.search.toLowerCase()))}}},R={class:"card"},G=["onClick"],H=["onClick"];function J(t,o,r,c,e,s){const d=i("Icon"),u=i("DataTable"),h=i("FormPositionModal"),f=i("DeletePositionModal");return C(),b(B,null,[n("main",null,[n("section",R,[n("header",null,[o[1]||(o[1]=n("h1",null,"Cargos",-1)),n("button",{class:"rounded",onClick:o[0]||(o[0]=l=>e.showFormPositionModal=!0),title:"Novo Cargo"},[a(d,{icon:"qlementine-icons:new-16"})])]),a(u,{items:s.filteredItems,columns:e.columns,loading:e.loading,totalItems:e.total,onOnSearch:s.handleSearch},{actions:m(({item:l})=>[n("button",{class:"rounded success",onClick:P=>s.handleEditPosition(l)},[a(d,{icon:"carbon:edit"})],8,G),n("button",{class:"rounded danger",onClick:P=>s.handleConfirmDelete(l)},[a(d,{icon:"carbon:trash-can"})],8,H)]),_:1},8,["items","columns","loading","totalItems","onOnSearch"])])]),a(h,{show:e.showFormPositionModal,dataForm:e.editItem,onOnClose:s.closeAllModals,onOnSave:s.refresh},null,8,["show","dataForm","onOnClose","onOnSave"]),a(f,{show:e.showDeletePositionModal,dataForm:e.editItem,onOnClose:s.closeAllModals,onOnConfirm:s.refresh},null,8,["show","dataForm","onOnClose","onOnConfirm"])],64)}const so=g(U,[["render",J],["__scopeId","data-v-8cac7a79"]]);export{so as default};
