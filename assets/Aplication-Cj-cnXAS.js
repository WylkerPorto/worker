import{u as g,a as _}from"./aplication-BbQEJJud.js";import{S as A}from"./SearchInput-wRdvrFLq.js";import{I,_ as b,c as m,a as n,g as r,d,t as y,h as S,e as f,r as u,F as V,i as E,f as c,w as p,o as s}from"./index-C0iXwPwW.js";import{M}from"./MyButton-8NTvTHKk.js";import"./http-lBh2inUk.js";import"./conversors-Bxahe57Q.js";const B={name:"UserAplication",components:{SearchInput:A,Icon:I,MyButton:M},data(){return{items:[],loading:!1,editItem:{},total:0,page:1,search:""}},mounted(){this.getApplications()},methods:{async getApplications(){this.loading=!0;try{const e=await _(localStorage.getItem("uid"),this.filters);this.total=e.data.meta.total,this.items.push(...e.data.data)}catch(e){this.$snotify.error("Erro ao buscar as vagas: "+e)}finally{this.loading=!1}},handleSearch(){this.page=1,this.items=[],this.getApplications()},handleLoadMore(){this.page+=1,this.getApplications()},async removeApplication(e){this.loading=!0;try{await g(e.id,{vacancyId:e.vacancy.id,status:"Candidatura Retirada"}),this.$snotify.success("Candidatura removida com sucesso!"),e.status="Candidatura Retirada"}catch(a){this.$snotify.error("Erro ao remover candidatura: "+a)}finally{this.loading=!1}},async reApply(e){this.loading=!0;try{await g(e.id,{vacancyId:e.vacancy.id,status:"Candidatura Enviada"}),this.$snotify.success("Candidatura reenviada com sucesso!"),e.status="Candidatura Enviada"}catch(a){this.$snotify.error("Erro ao reenviar candidatura: "+a)}finally{this.loading=!1}}},computed:{filters(){return{page:this.page,search:this.search}},loadMore(){return this.items.length<this.total}}},R={class:"container"},j={class:"btn-group"};function w(e,a,x,L,o,i){const v=u("SearchInput"),l=u("Icon"),k=u("RouterLink"),h=u("MyButton");return s(),m("main",R,[n("header",null,[n("h1",null,"Vagas candidatadas "+y(o.total),1),n("form",{onSubmit:a[1]||(a[1]=S((...t)=>i.handleSearch&&i.handleSearch(...t),["stop","prevent"]))},[f(v,{modelValue:o.search,"onUpdate:modelValue":a[0]||(a[0]=t=>o.search=t)},null,8,["modelValue"])],32)]),n("section",null,[(s(!0),m(V,null,E(o.items,t=>(s(),m("div",{class:"card",key:t.id},[n("h2",null,y(t.vacancy.title),1),n("p",null,[t.status=="Candidatura Enviada"?(s(),r(l,{key:0,icon:"pajamas:status"})):d("",!0),t.status=="Em AnÃ¡lise"?(s(),r(l,{key:1,icon:"pajamas:error"})):d("",!0),t.status=="Aprovada"?(s(),r(l,{key:2,icon:"pajamas:check-circle-dashed"})):d("",!0),t.status=="Rejeitada"?(s(),r(l,{key:3,icon:"pajamas:canceled-circle"})):d("",!0),t.status=="Candidatura Retirada"?(s(),r(l,{key:4,icon:"pajamas:multiple-choice"})):d("",!0),c(" "+y(t.status),1)]),n("div",j,[f(k,{class:"btn primary",to:{name:"userVacancyDetail",params:{id:t.vacancy.id}},target:"_blank"},{default:p(()=>a[2]||(a[2]=[c(" Ver detalhes ")])),_:2},1032,["to"]),t.status==="Candidatura Retirada"?(s(),r(h,{key:0,class:"btn success",type:"button",loading:o.loading,onClick:C=>i.reApply(t)},{default:p(()=>a[3]||(a[3]=[c(" Recandidatar ")])),_:2},1032,["loading","onClick"])):(s(),r(h,{key:1,class:"btn danger",type:"button",loading:o.loading,onClick:C=>i.removeApplication(t)},{default:p(()=>a[4]||(a[4]=[c(" Desistir ")])),_:2},1032,["loading","onClick"]))])]))),128))]),i.loadMore?(s(),r(h,{key:0,onClick:i.handleLoadMore},{default:p(()=>a[5]||(a[5]=[c("Carregar mais")])),_:1},8,["onClick"])):d("",!0)])}const z=b(B,[["render",w],["__scopeId","data-v-96b14463"]]);export{z as default};
