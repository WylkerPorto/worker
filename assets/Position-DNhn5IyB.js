import{D as b}from"./DataTable-Dff8oe2k.js";import{_,h as y,w as d,e as n,f as p,r as i,a,g as k,o as g,I as P,t as I,c as C,F as O}from"./index-CowVIONd.js";import{F as B,c as D,a as E}from"./FormInput-CxYatLeZ.js";import{M as w}from"./ModalBase-DwDLeHjt.js";import{M as v}from"./MyButton-0IIlnoKh.js";import{u as F,c as x,r as S,l as A}from"./position-DGMresNZ.js";import"./SearchInput-DHzUlEtB.js";import"./conversors-CPMu-DbH.js";import"./http-BD6d8YlU.js";const T={name:"FormPositionModal",components:{ModalBase:w,FormInput:B,MyButton:v},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onSave"],data(){return{form:{status:!1},errors:{},loading:!1}},watch:{dataForm(){this.dataForm&&(this.form={...this.form,...this.dataForm})}},methods:{validate(){D({name:E().required("Cargo é obrigatório")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.savePosition()}).catch(t=>{const l={};t.inner.forEach(h=>{l[h.path]=h.message}),this.errors=l})},async savePosition(){this.loading=!0;try{const o=!!this.form.id;o&&(delete this.form.id,delete this.form.createdAt,delete this.form.updatedAt,delete this.form.deletedAt),o?await F(this.dataForm.id,this.form):await x(this.form),this.$snotify.success(`Cargo ${o?"atualizado":"criado"} com sucesso`),this.$emit("onSave"),this.closeModal()}catch(o){this.$snotify.error("Erro ao salvar o cargo: "+o)}finally{this.loading=!1}},closeModal(){this.form={status:!1},this.errors={},this.$emit("onClose")}}};function N(o,t,l,h,e,s){const r=i("FormInput"),u=i("MyButton"),f=i("ModalBase");return g(),y(f,{open:l.show,loading:e.loading,title:"Novo Cargo",onOnClose:s.closeModal},{content:d(()=>[a("form",{onSubmit:t[1]||(t[1]=k((...c)=>s.validate&&s.validate(...c),["prevent"]))},[n(r,{label:"Cargo",type:"text",placeholder:"Digite o cargo",modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=c=>e.form.name=c),error:e.errors.name,required:""},null,8,["modelValue","error"])],32)]),actions:d(()=>[n(u,{class:"btn success",loading:e.loading,onClick:s.validate},{default:d(()=>t[2]||(t[2]=[p(" Salvar ")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading","onOnClose"])}const V=_(T,[["render",N],["__scopeId","data-v-ae27cfa0"]]),q={name:"DeletePositionModal",components:{ModalBase:w,Icon:P,MyButton:v},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onConfirm"],data(){return{loading:!1}},methods:{async deletePosition(){this.loading=!0;try{await S(this.dataForm.id),this.$snotify.success("Cargo excluído com sucesso!"),this.$emit("onConfirm"),this.$emit("onClose")}catch(o){this.$snotify.error("Erro ao excluir o cargo: "+o)}finally{this.loading=!1}}}};function z(o,t,l,h,e,s){const r=i("Icon"),u=i("MyButton"),f=i("ModalBase");return g(),y(f,{open:l.show,loading:e.loading,title:"Confirmar Exclusão",onOnClose:t[0]||(t[0]=c=>o.$emit("onClose"))},{content:d(()=>[a("section",null,[n(r,{icon:"carbon:warning"}),a("div",null,[a("p",null,[t[1]||(t[1]=p(" Tem certeza que deseja excluir o cargo ")),a("span",null,I(l.dataForm?.name),1),t[2]||(t[2]=p(" ? "))]),t[3]||(t[3]=a("p",null,"Essa ação não pode ser desfeita!",-1))])])]),actions:d(()=>[n(u,{class:"btn danger",loading:e.loading,onClick:s.deletePosition},{default:d(()=>t[4]||(t[4]=[p("Confirmar")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading"])}const L=_(q,[["render",z],["__scopeId","data-v-5b13b7af"]]),j={name:"RecruiterPosition",components:{DataTable:b,Icon:P,FormPositionModal:V,DeletePositionModal:L},data(){return{showFormPositionModal:!1,showDeletePositionModal:!1,loading:!1,columns:[{key:"name",title:"Nome"},{key:"status",title:"Status",type:"boolean"},{key:"createdAt",title:"Criado em",type:"date"}],items:[],editItem:{},total:0,page:1,search:""}},mounted(){this.getPositions()},methods:{refresh(){this.items=[],this.getPositions()},async getPositions(){this.closeAllModals(),this.loading=!0;try{const o=await A(this.filters);this.items.push(...o.data),this.total=o.data.total}catch(o){this.$snotify.error("Erro ao buscar os cargos: "+o)}finally{this.loading=!1}},async handleTogglePosition(o){this.loading=!0;try{o.status=!o.status,await F(o.id,{status:o.status}),this.$snotify.success("Cargo atualizado com sucesso!")}catch(t){this.$snotify.error("Erro ao atualizar o cargo: "+t),o.status=!o.status}finally{this.loading=!1}},handleSearch(o){this.search=o,this.page=1,this.items=[],this.getPositions()},handleNewPosition(){this.editItem={},this.showFormPositionModal=!0},handleEditPosition(o){this.editItem=o,this.showFormPositionModal=!0},handleConfirmDelete(o){this.editItem=o,this.showDeletePositionModal=!0},closeAllModals(){this.editItem={},this.showFormPositionModal=!1,this.showDeletePositionModal=!1},handleLoadMore(){this.page+=1,this.getPositions()}},computed:{filters(){return{page:this.page,filter:this.search}},loadMore(){return this.items.length<this.total}}},$={class:"card"},R=["onClick"],U=["onClick"],G=["onClick"],H=["onClick"];function J(o,t,l,h,e,s){const r=i("Icon"),u=i("DataTable"),f=i("FormPositionModal"),c=i("DeletePositionModal");return g(),C(O,null,[a("main",null,[a("section",$,[a("header",null,[t[1]||(t[1]=a("h1",null,"Cargos",-1)),a("button",{class:"rounded",onClick:t[0]||(t[0]=m=>e.showFormPositionModal=!0),title:"Novo Cargo"},[n(r,{icon:"qlementine-icons:new-16"})])]),n(u,{items:e.items,columns:e.columns,loading:e.loading,total:e.total,loadMore:s.loadMore,onOnLoadMore:s.handleLoadMore,onOnSearch:s.handleSearch},{actions:d(({item:m})=>[m.status?(g(),C("button",{key:0,class:"rounded warning",onClick:M=>s.handleTogglePosition(m),title:"Pausar"},[n(r,{icon:"ic:round-pause"})],8,R)):(g(),C("button",{key:1,class:"rounded primary",onClick:M=>s.handleTogglePosition(m),title:"Ativar"},[n(r,{icon:"ic:round-play-arrow"})],8,U)),a("button",{class:"rounded success",onClick:M=>s.handleEditPosition(m)},[n(r,{icon:"carbon:edit"})],8,G),a("button",{class:"rounded danger",onClick:M=>s.handleConfirmDelete(m)},[n(r,{icon:"carbon:trash-can"})],8,H)]),_:1},8,["items","columns","loading","total","loadMore","onOnLoadMore","onOnSearch"])])]),n(f,{show:e.showFormPositionModal,dataForm:e.editItem,onOnClose:s.closeAllModals,onOnSave:s.refresh},null,8,["show","dataForm","onOnClose","onOnSave"]),n(c,{show:e.showDeletePositionModal,dataForm:e.editItem,onOnClose:s.closeAllModals,onOnConfirm:s.refresh},null,8,["show","dataForm","onOnClose","onOnConfirm"])],64)}const so=_(j,[["render",J],["__scopeId","data-v-b2f93fa6"]]);export{so as default};
