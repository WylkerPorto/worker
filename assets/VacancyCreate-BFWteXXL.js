import{F as h,c as x,a as i,b as u,d as v}from"./FormInput-i2Z_CC7o.js";import{I as E,_ as M,c as q,a as s,e as t,r as d,g as S,w as c,f as V,o as w}from"./index-DUeOHcEa.js";import{M as T}from"./MyButton-CPDew2lw.js";import{M as I}from"./MySelect-BrViAwYp.js";import{M as k}from"./SwitchButton-C8JYLlzo.js";import{g as C,u as D,c as U}from"./vacancy-XuFOmxh_.js";import{l as L}from"./department-muf_-j4C.js";import{l as B}from"./position-CtCe6zu-.js";import{a as R,b as A}from"./filters-DcpaNWVD.js";import"./http-DlcZp92k.js";import"./conversors-B7KkBRJf.js";const F={name:"RecruiterVacancyCreate",components:{Icon:E,MyButton:T,MySelect:I,FormInput:h,SwitchButton:k},data(){return{form:{hideSalary:!1},errors:{},loading:!1,workModelList:[],employmentTypeList:[],departmentList:[],positionList:[]}},mounted(){this.isEditMode&&this.loadData(this.$route.params.id),this.getFilters(),this.form.recruiter=localStorage.getItem("uid")},methods:{validate(){x().shape({title:i().required("Título é obrigatório"),description:i().required("Descrição é obrigatória"),niceToHave:i(),responsibilities:i(),requirements:i(),workModel:i().required("Modelo de trabalho é obrigatório"),employmentType:i().required("Tipo de contratação é obrigatório"),salary:u().min(0,"Salário deve ser positivo").nullable(),hideSalary:v(),city:i().required("Cidade é obrigatória"),state:i().required("Estado é obrigatório"),departmentId:u().required("Departamento é obrigatório"),positionId:u().required("Cargo é obrigatório"),expirationDate:i().nullable()}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.saveVacancy()}).catch(r=>{const n={};r.inner.forEach(m=>{n[m.path]=m.message}),this.errors=n})},async saveVacancy(){this.loading=!0;try{this.isEditMode?(delete this.form.id,delete this.form.createdAt,delete this.form.updatedAt,delete this.form.deletedAt,delete this.form.slug,await D(this.$route.params.id,this.form)):await U(this.form),this.$snotify.success(`Vaga ${this.isEditMode?"atualizada":"criada"} com sucesso!`)}catch(l){this.$snotify.error("Erro ao salvar a vaga: "+l.message)}finally{this.loading=!1}},async getFilters(){try{const[l,r,n,m]=await Promise.all([R(),A(),L(),B()]);this.workModelList=l.data?.map(e=>({id:e.title,title:e.title}))||[],this.employmentTypeList=r.data?.map(e=>({id:e.title,title:e.title}))||[],this.departmentList=n.data?.map(e=>({id:e.id,title:e.name}))||[],this.positionList=m.data?.map(e=>({id:e.id,title:e.name}))||[]}catch(l){console.error("Error fetching filters:",l)}},async loadData(l){this.loading=!0;try{const r=await C(l);this.form=r.data}catch(r){console.error("Error loading data:",r)}finally{this.loading=!1}}},computed:{isEditMode(){return!!this.$route.params.id}}},P={class:"main"},H={class:"card"},N={class:"flex"},j={class:"flex"},z={class:"flex"},J={class:"column"};function K(l,r,n,m,e,f){const b=d("Icon"),a=d("FormInput"),p=d("MySelect"),g=d("SwitchButton"),y=d("MyButton");return w(),q("main",P,[s("section",H,[s("header",null,[s("button",{class:"rounded",onClick:r[0]||(r[0]=o=>l.$router.push({name:"recruiterVacancy"})),title:"Voltar"},[t(b,{icon:"lets-icons:back"})]),r[17]||(r[17]=s("h1",null,"Criar Vaga",-1))]),s("form",{onSubmit:r[16]||(r[16]=S((...o)=>f.validate&&f.validate(...o),["prevent"]))},[t(a,{label:"Título",type:"text",placeholder:"Analista de Sistemas Sênior",modelValue:e.form.title,"onUpdate:modelValue":r[1]||(r[1]=o=>e.form.title=o),error:e.errors.title,required:""},null,8,["modelValue","error"]),t(a,{label:"Descrição",type:"text",placeholder:"Descrição completa da vaga.",modelValue:e.form.description,"onUpdate:modelValue":r[2]||(r[2]=o=>e.form.description=o),error:e.errors.description,required:""},null,8,["modelValue","error"]),s("div",N,[t(p,{label:"Departamento",options:e.departmentList,modelValue:e.form.departmentId,"onUpdate:modelValue":r[3]||(r[3]=o=>e.form.departmentId=o),error:e.errors.departmentId,required:""},null,8,["options","modelValue","error"]),t(p,{label:"Cargo",options:e.positionList,modelValue:e.form.positionId,"onUpdate:modelValue":r[4]||(r[4]=o=>e.form.positionId=o),error:e.errors.positionId,required:""},null,8,["options","modelValue","error"])]),t(a,{label:"Conhecimento Desejável",type:"text",placeholder:"Experiência com Docker, Kubernetes.",modelValue:e.form.niceToHave,"onUpdate:modelValue":r[5]||(r[5]=o=>e.form.niceToHave=o),error:e.errors.niceToHave,required:""},null,8,["modelValue","error"]),t(a,{label:"Responsabilidades",type:"text",placeholder:"Desenvolver APIs, integrar sistemas",modelValue:e.form.responsibilities,"onUpdate:modelValue":r[6]||(r[6]=o=>e.form.responsibilities=o),error:e.errors.responsibilities,required:""},null,8,["modelValue","error"]),t(a,{label:"Requisitos",type:"text",placeholder:"Conhecimentos sólidos em NestJS, PostgreSQL.",modelValue:e.form.requirements,"onUpdate:modelValue":r[7]||(r[7]=o=>e.form.requirements=o),error:e.errors.requirements,required:""},null,8,["modelValue","error"]),s("div",j,[t(p,{label:"Modelo de Trabalho",options:e.workModelList,modelValue:e.form.workModel,"onUpdate:modelValue":r[8]||(r[8]=o=>e.form.workModel=o),error:e.errors.workModel,required:""},null,8,["options","modelValue","error"]),t(p,{label:"Tipo de Contratação",options:e.employmentTypeList,modelValue:e.form.employmentType,"onUpdate:modelValue":r[9]||(r[9]=o=>e.form.employmentType=o),error:e.errors.employmentType,required:""},null,8,["options","modelValue","error"])]),s("div",z,[t(a,{label:"Validade",type:"date",modelValue:e.form.expirationDate,"onUpdate:modelValue":r[10]||(r[10]=o=>e.form.expirationDate=o),error:e.errors.expirationDate},null,8,["modelValue","error"]),t(a,{label:"Salário (R$)",type:"number",placeholder:"5000",modelValue:e.form.salary,"onUpdate:modelValue":r[11]||(r[11]=o=>e.form.salary=o),modelModifiers:{number:!0},error:e.errors.salary},null,8,["modelValue","error"]),s("div",J,[r[18]||(r[18]=s("span",null,"Esconder salário",-1)),t(g,{modelValue:e.form.hideSalary,"onUpdate:modelValue":r[12]||(r[12]=o=>e.form.hideSalary=o)},null,8,["modelValue"])])]),t(a,{label:"Cidade",type:"text",placeholder:"São Paulo",modelValue:e.form.city,"onUpdate:modelValue":r[13]||(r[13]=o=>e.form.city=o),error:e.errors.city},null,8,["modelValue","error"]),t(a,{label:"Estado",type:"text",placeholder:"SP",modelValue:e.form.state,"onUpdate:modelValue":r[14]||(r[14]=o=>e.form.state=o),error:e.errors.state},null,8,["modelValue","error"]),t(y,{class:"btn success",type:"submit",loading:e.loading},{default:c(()=>r[19]||(r[19]=[V(" Salvar Vaga ")])),_:1},8,["loading"]),t(y,{class:"btn danger",onClick:r[15]||(r[15]=o=>l.$router.push({name:"recruiterVacancy"}))},{default:c(()=>r[20]||(r[20]=[V(" Cancelar ")])),_:1})],32)])])}const oe=M(F,[["render",K],["__scopeId","data-v-87beafa6"]]);export{oe as default};
