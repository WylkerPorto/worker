import{F as h,c as x,a as i,b as u,d as v}from"./FormInput-DhiMcDjK.js";import{I as E,_ as M,c as q,a as s,e as t,r as d,g as S,w as y,f as V,o as w}from"./index-DI6tQA7K.js";import{M as T}from"./MyButton-BbttQ0pn.js";import{M as I,g as k,a as C}from"./filters-CIve8qP0.js";import{M as L}from"./SwitchButton-agQTU3Ge.js";import{g as U,u as D,c as B}from"./vacancy-BiBzpFPG.js";import{l as R}from"./department-BzlGmQDj.js";import{l as A}from"./position-5kGKf7wl.js";import"./http-BD6d8YlU.js";import"./conversors-iuaU3Whz.js";const F={name:"RecruiterVacancyCreate",components:{Icon:E,MyButton:T,MySelect:I,FormInput:h,SwitchButton:L},data(){return{form:{hideSalary:!1},errors:{},loading:!1,workModelList:[],employmentTypeList:[],departmentList:[],positionList:[]}},mounted(){this.isEditMode&&this.loadData(this.$route.params.id),this.getFilters(),this.form.recruiter=localStorage.getItem("uid")},methods:{validate(){x().shape({title:i().required("Título é obrigatório"),description:i().required("Descrição é obrigatória"),niceToHave:i(),responsibilities:i(),requirements:i(),workModel:i().required("Modelo de trabalho é obrigatório"),employmentType:i().required("Tipo de contratação é obrigatório"),salary:u().min(0,"Salário deve ser positivo").nullable(),hideSalary:v(),city:i().required("Cidade é obrigatória"),state:i().required("Estado é obrigatório"),departmentId:u().required("Departamento é obrigatório"),positionId:u().required("Cargo é obrigatório"),expirationDate:i().nullable()}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.saveVacancy()}).catch(o=>{const n={};o.inner.forEach(m=>{n[m.path]=m.message}),this.errors=n})},async saveVacancy(){this.loading=!0;try{this.isEditMode?(delete this.form.id,delete this.form.createdAt,delete this.form.updatedAt,delete this.form.deletedAt,delete this.form.slug,await D(this.$route.params.id,this.form)):await B(this.form),this.$snotify.success(`Vaga ${this.isEditMode?"atualizada":"criada"} com sucesso!`)}catch(l){this.$snotify.error("Erro ao salvar a vaga: "+l.message)}finally{this.loading=!1}},async getFilters(){try{const[l,o,n,m]=await Promise.all([k(),C(),R(),A()]);this.workModelList=l.data?.map(e=>({id:e.title,title:e.title}))||[],this.employmentTypeList=o.data?.map(e=>({id:e.title,title:e.title}))||[],this.departmentList=n.data?.map(e=>({id:e.id,title:e.name}))||[],this.positionList=m.data?.map(e=>({id:e.id,title:e.name}))||[]}catch(l){console.error("Error fetching filters:",l)}},async loadData(l){this.loading=!0;try{const o=await U(l);this.form=o.data}catch(o){console.error("Error loading data:",o)}finally{this.loading=!1}}},computed:{isEditMode(){return!!this.$route.params.id}}},P={class:"main"},H={class:"card"},N={class:"flex"},j={class:"flex"},z={class:"flex"},J={class:"column"};function K(l,o,n,m,e,f){const b=d("Icon"),a=d("FormInput"),p=d("MySelect"),g=d("SwitchButton"),c=d("MyButton");return w(),q("main",P,[s("section",H,[s("header",null,[s("button",{class:"rounded",onClick:o[0]||(o[0]=r=>l.$router.push({name:"recruiterVacancy"})),title:"Voltar"},[t(b,{icon:"lets-icons:back"})]),o[16]||(o[16]=s("h1",null,"Criar Vaga",-1))]),s("form",{onSubmit:o[15]||(o[15]=S((...r)=>f.validate&&f.validate(...r),["prevent"]))},[t(a,{label:"Título",type:"text",placeholder:"Analista de Sistemas Sênior",modelValue:e.form.title,"onUpdate:modelValue":o[1]||(o[1]=r=>e.form.title=r),error:e.errors.title,required:""},null,8,["modelValue","error"]),t(a,{label:"Descrição",type:"text",placeholder:"Descrição completa da vaga.",modelValue:e.form.description,"onUpdate:modelValue":o[2]||(o[2]=r=>e.form.description=r),error:e.errors.description,required:""},null,8,["modelValue","error"]),s("div",N,[t(p,{label:"Departamento",options:e.departmentList,modelValue:e.form.departmentId,"onUpdate:modelValue":o[3]||(o[3]=r=>e.form.departmentId=r),error:e.errors.departmentId,required:""},null,8,["options","modelValue","error"]),t(p,{label:"Cargo",options:e.positionList,modelValue:e.form.positionId,"onUpdate:modelValue":o[4]||(o[4]=r=>e.form.positionId=r),error:e.errors.positionId,required:""},null,8,["options","modelValue","error"])]),t(a,{label:"Conhecimento Desejável",type:"text",placeholder:"Experiência com Docker, Kubernetes.",modelValue:e.form.niceToHave,"onUpdate:modelValue":o[5]||(o[5]=r=>e.form.niceToHave=r),error:e.errors.niceToHave,required:""},null,8,["modelValue","error"]),t(a,{label:"Responsabilidades",type:"text",placeholder:"Desenvolver APIs, integrar sistemas",modelValue:e.form.responsibilities,"onUpdate:modelValue":o[6]||(o[6]=r=>e.form.responsibilities=r),error:e.errors.responsibilities,required:""},null,8,["modelValue","error"]),t(a,{label:"Requisitos",type:"text",placeholder:"Conhecimentos sólidos em NestJS, PostgreSQL.",modelValue:e.form.requirements,"onUpdate:modelValue":o[7]||(o[7]=r=>e.form.requirements=r),error:e.errors.requirements,required:""},null,8,["modelValue","error"]),s("div",j,[t(p,{label:"Modelo de Trabalho",options:e.workModelList,modelValue:e.form.workModel,"onUpdate:modelValue":o[8]||(o[8]=r=>e.form.workModel=r),error:e.errors.workModel,required:""},null,8,["options","modelValue","error"]),t(p,{label:"Tipo de Contratação",options:e.employmentTypeList,modelValue:e.form.employmentType,"onUpdate:modelValue":o[9]||(o[9]=r=>e.form.employmentType=r),error:e.errors.employmentType,required:""},null,8,["options","modelValue","error"])]),s("div",z,[t(a,{label:"Salário (R$)",type:"number",placeholder:"5000",modelValue:e.form.salary,"onUpdate:modelValue":o[10]||(o[10]=r=>e.form.salary=r),modelModifiers:{number:!0},error:e.errors.salary},null,8,["modelValue","error"]),s("div",J,[o[17]||(o[17]=s("span",null,"Esconder salário",-1)),t(g,{modelValue:e.form.hideSalary,"onUpdate:modelValue":o[11]||(o[11]=r=>e.form.hideSalary=r)},null,8,["modelValue"])])]),t(a,{label:"Cidade",type:"text",placeholder:"São Paulo",modelValue:e.form.city,"onUpdate:modelValue":o[12]||(o[12]=r=>e.form.city=r),error:e.errors.city},null,8,["modelValue","error"]),t(a,{label:"Estado",type:"text",placeholder:"SP",modelValue:e.form.state,"onUpdate:modelValue":o[13]||(o[13]=r=>e.form.state=r),error:e.errors.state},null,8,["modelValue","error"]),t(c,{class:"btn success",type:"submit",loading:e.loading},{default:y(()=>o[18]||(o[18]=[V(" Salvar Vaga ")])),_:1},8,["loading"]),t(c,{class:"btn danger",onClick:o[14]||(o[14]=r=>l.$router.push({name:"recruiterVacancy"}))},{default:y(()=>o[19]||(o[19]=[V(" Cancelar ")])),_:1})],32)])])}const oe=M(F,[["render",K],["__scopeId","data-v-801dc0bc"]]);export{oe as default};
