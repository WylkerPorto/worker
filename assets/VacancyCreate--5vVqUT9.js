import{F as S,c as k,a as n,b as h,d as C}from"./FormInput-vldQscfs.js";import{Q as I,_ as q,c,d as g,a as s,t as E,e as l,r as d,j as T,o as f,I as w,h as D,w as x,f as v}from"./index-Mu0760Vm.js";import{M as U}from"./MyButton-CAWIgk02.js";import{M as L}from"./MySelect-CM3N3LWX.js";import{M as B}from"./SwitchButton-Dcz87ajI.js";import{a as R,u as A,c as F}from"./vacancy-BAPdMDMv.js";import{l as _}from"./department-sP2gsjK2.js";import{l as H}from"./position-2dbD_-kw.js";import{a as N,b as Q}from"./filters-BMeN6P-b.js";import"./http-CXuHNYXv.js";import"./conversors-CKfFtFQ4.js";const P={name:"MyEditor",components:{QuillEditor:I},props:{label:String,placeholder:String,modelValue:String,error:String},emits:["update:modelValue"],data(){return{quillContent:this.modelValue||"",options:{modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{align:[]},{indent:"-1"},{indent:"+1"}],[{list:"ordered"},{list:"bullet"},{list:"check"}],["blockquote","code-block"],["link","formula"],[{script:"sub"},{script:"super"}],[{direction:"rtl"}],["clean"]]},theme:"snow"}}},watch:{modelValue(t){t!==this.quillContent&&(this.quillContent=t||"")},quillContent(t){t==="<p><br></p>"||t.trim()===""?this.$emit("update:modelValue",""):this.$emit("update:modelValue",t)}}},j={key:0,for:"editor"},z={key:1};function K(t,o,i,m,e,y){const V=d("QuillEditor");return f(),c("main",null,[i.label?(f(),c("label",j,E(i.label),1)):g("",!0),s("div",{class:T({error:i.error})},[l(V,{content:e.quillContent,"onUpdate:content":o[0]||(o[0]=a=>e.quillContent=a),placeholder:i.placeholder,options:e.options,contentType:"html"},null,8,["content","placeholder","options"])],2),i.error?(f(),c("span",z,E(i.error),1)):g("",!0)])}const W=q(P,[["render",K],["__scopeId","data-v-c5e4fd90"]]),G={name:"RecruiterVacancyCreate",components:{Icon:w,Editor:W,MyButton:U,MySelect:L,FormInput:S,SwitchButton:B},data(){return{form:{hideSalary:!1},errors:{},loading:!1,workModelList:[],employmentTypeList:[],departmentList:[],positionList:[]}},mounted(){this.isEditMode&&this.loadData(this.$route.params.id),this.getFilters(),this.form.recruiter=localStorage.getItem("uid")},methods:{validate(){k().shape({title:n().required("Título é obrigatório"),description:n().required("Descrição é obrigatória"),niceToHave:n(),responsibilities:n(),requirements:n(),workModel:n().required("Modelo de trabalho é obrigatório"),employmentType:n().required("Tipo de contratação é obrigatório"),salary:h().min(0,"Salário deve ser positivo").nullable(),hideSalary:C(),city:n().required("Cidade é obrigatória"),state:n().required("Estado é obrigatório"),departmentId:h().required("Departamento é obrigatório"),positionId:h().required("Cargo é obrigatório"),expirationDate:n().nullable()}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.saveVacancy()}).catch(o=>{const i={};o.inner.forEach(m=>{i[m.path]=m.message}),this.errors=i})},async saveVacancy(){this.loading=!0;try{this.isEditMode?(delete this.form.id,delete this.form.createdAt,delete this.form.updatedAt,delete this.form.deletedAt,delete this.form.slug,delete this.form.applications,delete this.form.isApplied,await A(this.$route.params.id,this.form)):await F(this.form),this.$snotify.success(`Vaga ${this.isEditMode?"atualizada":"criada"} com sucesso!`),this.$router.push({name:"recruiterVacancy"})}catch(t){this.$snotify.error("Erro ao salvar a vaga: "+t.message)}finally{this.loading=!1}},async getFilters(){try{const[t,o,i,m]=await Promise.all([N(),Q(),_(),H()]);this.workModelList=t.data?.map(e=>({id:e.title,title:e.title}))||[],this.employmentTypeList=o.data?.map(e=>({id:e.title,title:e.title}))||[],this.departmentList=i.data?.map(e=>({id:e.id,title:e.name}))||[],this.positionList=m.data?.map(e=>({id:e.id,title:e.name}))||[]}catch(t){console.error("Error fetching filters:",t)}},async loadData(t){this.loading=!0;try{const o=await R(t);this.form=o.data,this.form.departmentId=this.form.department.id,this.form.positionId=this.form.position.id,delete this.form.department,delete this.form.position}catch(o){o.response.status===404&&(this.$snotify.error("Vaga não encontrada"),this.$router.push({name:"recruiterVacancy"}))}finally{this.loading=!1}}},computed:{isEditMode(){return!!this.$route.params.id}}},J={class:"main"},O={class:"card"},X={class:"flex"},Y={class:"flex"},Z={class:"flex"},$={class:"column"};function ee(t,o,i,m,e,y){const V=d("Icon"),a=d("FormInput"),u=d("Editor"),p=d("MySelect"),M=d("SwitchButton"),b=d("MyButton");return f(),c("main",J,[s("section",O,[s("header",null,[s("button",{class:"rounded",onClick:o[0]||(o[0]=r=>t.$router.push({name:"recruiterVacancy"})),title:"Voltar"},[l(V,{icon:"lets-icons:back"})]),o[17]||(o[17]=s("h1",null,"Criar Vaga",-1))]),s("form",{onSubmit:o[16]||(o[16]=D((...r)=>y.validate&&y.validate(...r),["prevent"]))},[l(a,{label:"Título",type:"text",placeholder:"Analista de Sistemas Sênior",modelValue:e.form.title,"onUpdate:modelValue":o[1]||(o[1]=r=>e.form.title=r),error:e.errors.title,required:""},null,8,["modelValue","error"]),l(u,{label:"Descrição",placeholder:"Descrição completa da vaga.",modelValue:e.form.description,"onUpdate:modelValue":o[2]||(o[2]=r=>e.form.description=r),error:e.errors.description,required:""},null,8,["modelValue","error"]),s("div",X,[l(p,{label:"Departamento",options:e.departmentList,modelValue:e.form.departmentId,"onUpdate:modelValue":o[3]||(o[3]=r=>e.form.departmentId=r),error:e.errors.departmentId,required:""},null,8,["options","modelValue","error"]),l(p,{label:"Cargo",options:e.positionList,modelValue:e.form.positionId,"onUpdate:modelValue":o[4]||(o[4]=r=>e.form.positionId=r),error:e.errors.positionId,required:""},null,8,["options","modelValue","error"])]),l(u,{label:"Conhecimento Desejável",placeholder:"Experiência com Docker, Kubernetes.",modelValue:e.form.niceToHave,"onUpdate:modelValue":o[5]||(o[5]=r=>e.form.niceToHave=r),error:e.errors.niceToHave,required:""},null,8,["modelValue","error"]),l(u,{label:"Responsabilidades",placeholder:"Descrição completa da vaga.",modelValue:e.form.responsibilities,"onUpdate:modelValue":o[6]||(o[6]=r=>e.form.responsibilities=r),error:e.errors.responsibilities,required:""},null,8,["modelValue","error"]),l(u,{label:"Requisitos",placeholder:"Descrição completa da vaga.",modelValue:e.form.requirements,"onUpdate:modelValue":o[7]||(o[7]=r=>e.form.requirements=r),error:e.errors.requirements,required:""},null,8,["modelValue","error"]),s("div",Y,[l(p,{label:"Modelo de Trabalho",options:e.workModelList,modelValue:e.form.workModel,"onUpdate:modelValue":o[8]||(o[8]=r=>e.form.workModel=r),error:e.errors.workModel,required:""},null,8,["options","modelValue","error"]),l(p,{label:"Tipo de Contratação",options:e.employmentTypeList,modelValue:e.form.employmentType,"onUpdate:modelValue":o[9]||(o[9]=r=>e.form.employmentType=r),error:e.errors.employmentType,required:""},null,8,["options","modelValue","error"])]),s("div",Z,[l(a,{label:"Validade",type:"date",modelValue:e.form.expirationDate,"onUpdate:modelValue":o[10]||(o[10]=r=>e.form.expirationDate=r),error:e.errors.expirationDate},null,8,["modelValue","error"]),l(a,{label:"Salário (R$)",type:"number",placeholder:"5000",modelValue:e.form.salary,"onUpdate:modelValue":o[11]||(o[11]=r=>e.form.salary=r),modelModifiers:{number:!0},error:e.errors.salary},null,8,["modelValue","error"]),s("div",$,[o[18]||(o[18]=s("span",null,"Esconder salário",-1)),l(M,{modelValue:e.form.hideSalary,"onUpdate:modelValue":o[12]||(o[12]=r=>e.form.hideSalary=r)},null,8,["modelValue"])])]),l(a,{label:"Cidade",type:"text",placeholder:"São Paulo",modelValue:e.form.city,"onUpdate:modelValue":o[13]||(o[13]=r=>e.form.city=r),error:e.errors.city},null,8,["modelValue","error"]),l(a,{label:"Estado",type:"text",placeholder:"SP",modelValue:e.form.state,"onUpdate:modelValue":o[14]||(o[14]=r=>e.form.state=r),error:e.errors.state},null,8,["modelValue","error"]),l(b,{class:"btn success",type:"submit",loading:e.loading},{default:x(()=>o[19]||(o[19]=[v(" Salvar Vaga ")])),_:1},8,["loading"]),l(b,{class:"btn danger",onClick:o[15]||(o[15]=r=>t.$router.push({name:"recruiterVacancy"}))},{default:x(()=>o[20]||(o[20]=[v(" Cancelar ")])),_:1})],32)])])}const pe=q(G,[["render",ee],["__scopeId","data-v-6cb5665d"]]);export{pe as default};
