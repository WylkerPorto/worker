import{D as I}from"./DataTable-BlcHQmC8.js";import{_ as M,g as R,w as m,e as a,f as g,r as l,a as s,h as F,o as w,I as v,t as C,c as D,F as O}from"./index-BLcxalff.js";import{F as S,c as B,a as p}from"./FormInput-C5ftnFIk.js";import{M as y}from"./ModalBase-s2-wMfuw.js";import{M as _}from"./MyButton-DrcBuMc_.js";import{u as E,c as k,l as x}from"./recruiter-CVXVC8vy.js";import{r as V}from"./user-BCqFKrhh.js";import"./SearchInput-Ba4cr6qp.js";import"./conversors-a5ARN5za.js";import"./http-BgvyJrsg.js";const P={name:"FormRecruiterModal",components:{ModalBase:y,FormInput:S,MyButton:_},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onSave"],data(){return{form:{permissionId:3},errors:{},loading:!1}},watch:{dataForm(){this.dataForm&&(this.form={...this.form,...this.dataForm})}},methods:{validate(){B({name:p().required("Nome é obrigatório"),email:p().email("E-mail inválido").required("E-mail é obrigatório"),password:this.form.id?p().min(6,"Senha deve ter pelo menos 6 caracteres"):p().min(6,"Senha deve ter pelo menos 6 caracteres").required("Senha é obrigatória")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.saveRecruiter()}).catch(e=>{const d={};e.inner.forEach(u=>{d[u.path]=u.message}),this.errors=d})},async saveRecruiter(){this.loading=!0;try{const o=!!this.form.id;o&&(delete this.form.id,delete this.form.createdAt,delete this.form.updatedAt),o&&!this.form.password&&delete this.form.password,o?await E(this.dataForm.id,this.form):await k(this.form),this.$snotify.success(`Recrutador ${o?"atualizado":"criado"} com sucesso`),this.$emit("onSave"),this.closeModal()}catch(o){this.$snotify.error("Erro ao salvar o recrutador: "+o)}finally{this.loading=!1}},closeModal(){this.form={permissionId:3},this.errors={},this.$emit("onClose")}}};function N(o,e,d,u,t,r){const i=l("FormInput"),h=l("MyButton"),f=l("ModalBase");return w(),R(f,{open:d.show,loading:t.loading,title:"Novo Recrutador",onOnClose:r.closeModal},{content:m(()=>[s("form",{onSubmit:e[3]||(e[3]=F((...n)=>r.validate&&r.validate(...n),["prevent"]))},[a(i,{label:"Nome",type:"text",placeholder:"Digite o nome",modelValue:t.form.name,"onUpdate:modelValue":e[0]||(e[0]=n=>t.form.name=n),error:t.errors.name,required:""},null,8,["modelValue","error"]),a(i,{label:"E-mail",type:"email",placeholder:"Digite o e-mail",modelValue:t.form.email,"onUpdate:modelValue":e[1]||(e[1]=n=>t.form.email=n),error:t.errors.email,required:""},null,8,["modelValue","error"]),a(i,{label:"Senha",type:"password",placeholder:"Digite a senha",modelValue:t.form.password,"onUpdate:modelValue":e[2]||(e[2]=n=>t.form.password=n),error:t.errors.password,required:""},null,8,["modelValue","error"])],32)]),actions:m(()=>[a(h,{class:"btn success",loading:t.loading,onClick:r.validate},{default:m(()=>e[4]||(e[4]=[g(" Salvar ")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading","onOnClose"])}const A=M(P,[["render",N],["__scopeId","data-v-03564267"]]),q={name:"DeleteRecruiterModal",components:{ModalBase:y,Icon:v,MyButton:_},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onConfirm"],data(){return{loading:!1}},methods:{async deleteRecrutador(){this.loading=!0;try{await V(this.dataForm.id),this.$snotify.success("Recrutador excluído com sucesso!"),this.$emit("onConfirm"),this.$emit("onClose")}catch(o){this.$snotify.error("Erro ao excluir o recrutador: "+o)}finally{this.loading=!1}}}};function T(o,e,d,u,t,r){const i=l("Icon"),h=l("MyButton"),f=l("ModalBase");return w(),R(f,{open:d.show,loading:t.loading,title:"Confirmar Exclusão",onOnClose:e[0]||(e[0]=n=>o.$emit("onClose"))},{content:m(()=>[s("section",null,[a(i,{icon:"carbon:warning"}),s("div",null,[s("p",null,[e[1]||(e[1]=g(" Tem certeza que deseja excluir o recrutador ")),s("span",null,C(d.dataForm?.name),1),e[2]||(e[2]=g(" ? "))]),e[3]||(e[3]=s("p",null,"Essa ação não pode ser desfeita!",-1))])])]),actions:m(()=>[a(h,{class:"btn danger",loading:t.loading,onClick:r.deleteRecrutador},{default:m(()=>e[4]||(e[4]=[g("Confirmar")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading"])}const j=M(q,[["render",T],["__scopeId","data-v-d603ab6f"]]),L={name:"SupervisorController",components:{DataTable:I,Icon:v,FormRecruiterModal:A,DeleteRecruiterModal:j},data(){return{showDeleteRecruiterModal:!1,showRecruiterModal:!1,loading:!1,columns:[{key:"name",title:"Nome"},{key:"email",title:"Email"},{key:"createdAt",title:"Criado em",type:"date"}],items:[],editItem:{},total:0,page:1,totalPage:0,search:""}},mounted(){this.getRecruiters()},methods:{refresh(){this.items=[],this.getRecruiters()},async getRecruiters(){this.closeAllModals(),this.loading=!0;try{const{data:o}=await x(this.filters);this.items=o.data,this.total=o.total,this.totalPage=Math.ceil(o.total/o.per_page)}catch(o){this.$snotify.error("Erro ao buscar os recrutadores: "+o)}finally{this.loading=!1}},handleSearch(o){this.search=o,this.page=1,this.items=[],this.getRecruiters()},handleNewSupervisor(){this.editItem={},this.showRecruiterModal=!0},handleEditRecruiter(o){this.editItem=o,this.showRecruiterModal=!0},handleConfirmDelete(o){this.editItem=o,this.showDeleteRecruiterModal=!0},closeAllModals(){this.editItem={},this.showRecruiterModal=!1,this.showDeleteRecruiterModal=!1},handleLoadMore(o){this.page+=o,this.getRecruiters()}},computed:{filters(){return{page:this.page,filter:this.search}}}},U={class:"card"},z=["onClick"],G=["onClick"];function H(o,e,d,u,t,r){const i=l("Icon"),h=l("DataTable"),f=l("FormRecruiterModal"),n=l("DeleteRecruiterModal");return w(),D(O,null,[s("main",null,[s("section",U,[s("header",null,[e[3]||(e[3]=s("h1",null,"Recrutadores",-1)),s("button",{class:"rounded",onClick:e[0]||(e[0]=c=>t.showRecruiterModal=!0)},[a(i,{icon:"tdesign:user-add"})])]),a(h,{items:t.items,columns:t.columns,loading:t.loading,totalItems:t.total,totalPage:t.totalPage,currentPage:t.page,onOnSearch:r.handleSearch,onOnNextPage:e[1]||(e[1]=c=>r.handleLoadMore(1)),onOnPreviousPage:e[2]||(e[2]=c=>r.handleLoadMore(-1))},{createdAt:m(({item:c})=>[s("p",null,C(c),1)]),actions:m(({item:c})=>[s("button",{class:"rounded success",onClick:b=>r.handleEditRecruiter(c)},[a(i,{icon:"carbon:edit"})],8,z),s("button",{class:"rounded danger",onClick:b=>r.handleConfirmDelete(c)},[a(i,{icon:"carbon:trash-can"})],8,G)]),_:1},8,["items","columns","loading","totalItems","totalPage","currentPage","onOnSearch"])])]),a(f,{show:t.showRecruiterModal,dataForm:t.editItem,onOnClose:r.closeAllModals,onOnSave:r.refresh},null,8,["show","dataForm","onOnClose","onOnSave"]),a(n,{show:t.showDeleteRecruiterModal,dataForm:t.editItem,onOnClose:r.closeAllModals,onOnConfirm:r.refresh},null,8,["show","dataForm","onOnClose","onOnConfirm"])],64)}const te=M(L,[["render",H],["__scopeId","data-v-19fb9507"]]);export{te as default};
