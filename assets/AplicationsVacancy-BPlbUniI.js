import{u as w,g as k}from"./aplication-D4375JLh.js";import{c as _}from"./filters-BH_NHBH_.js";import{g as C}from"./vacancy-DIdU_Tz9.js";import{D}from"./DataTable-bBTRJRZW.js";import{I as S,_ as V,c,a as s,b,e as r,r as u,t as m,w as g,n as A,F as I,i as v,o as d}from"./index-CxRuIuR0.js";import"./http-CmPME1wD.js";import"./conversors-DMBNotbN.js";import"./SearchInput-DmBqsgOJ.js";import"./MyButton-4V4odv-_.js";const B={name:"AplicationsVacancy",components:{DataTable:D,Icon:S},data(){return{openDropdownItem:null,dropdownStyles:{position:"absolute",top:"0px",left:"0px"},vaga:{},items:[],columns:[{key:"person.name",title:"Nome"},{key:"person.email",title:"Email"},{key:"status",title:"Estado"},{key:"createdAt",title:"Criado em",type:"date"}],aplicationStatus:[],loading:!1,total:0,page:1,search:""}},mounted(){this.getAplicationsByVacancy(),this.getVacancyDetail(),this.getAplicationStatus(),document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)},methods:{async getAplicationStatus(){try{const t=await _();this.aplicationStatus=t.data}catch(t){this.$snotify.error(t)}},async getAplicationsByVacancy(){this.loading=!0;try{const t=await k(this.$route.params.id,this.filters);this.items.push(...t.data.data),this.total=t.data.meta.total}catch(t){this.$snotify.error(t)}finally{this.loading=!1}},async getVacancyDetail(){this.loading=!0;try{const t=await C(this.$route.params.id);this.vaga=t.data}catch(t){this.$snotify.error(t)}finally{this.loading=!1}},handleLoadMore(){this.page++,this.getAplicationsByVacancy()},handleSearch(t){this.search=t,this.page=1,this.items=[],this.getAplicationsByVacancy()},async handleToggleStatus(t,a){this.loading=!0;const e={...t};try{e.status=a,delete e.id,delete e.updatedAt,delete e.createdAt,delete e.vacancy,delete e.person,await w(t.id,e),this.$snotify.success("Candidatura atualizada com sucesso!"),t.status=a}catch(l){this.$snotify.error("Erro ao atualizar candidatura: "+l)}finally{this.openDropdownItem=null,this.loading=!1}},toggleDropdown(t,a){const e=t.target.getBoundingClientRect();if(this.openDropdownItem===a){this.openDropdownItem=null;return}this.openDropdownItem=a,this.dropdownStyles={position:"absolute",top:`${e.bottom+8}px`,left:`${e.left-60}px`}},handleClickOutside(t){setTimeout(()=>{const a=this.$refs.dropdown,e=t.target,l=t.target.closest(".actions");a&&!a.contains(e)&&!l&&(this.openDropdownItem=null)},0)}},computed:{filters(){return{page:this.page,search:this.search}},loadMore(){return this.items.length<this.total}}},L={class:"card"},M=["onClick"],x=["onClick"];function E(t,a,e,l,o,i){const p=u("Icon"),y=u("RouterLink"),f=u("DataTable");return d(),c("main",null,[s("section",L,[s("header",null,[s("button",{class:"rounded",onClick:a[0]||(a[0]=n=>t.$router.push({name:"recruiterVacancy"})),title:"Voltar"},[r(p,{icon:"lets-icons:back"})]),s("h1",null,"Candidatos a vaga "+m(o.vaga.title),1)]),r(f,{items:o.items,columns:o.columns,loading:o.loading,total:o.total,loadMore:i.loadMore,onOnLoadMore:i.handleLoadMore,onOnSearch:i.handleSearch},{actions:g(({item:n})=>[s("button",{class:"rounded",onClick:h=>i.toggleDropdown(h,n),title:"Editar Status"},[r(p,{icon:"fluent:status-12-filled"})],8,M),r(y,{class:"rounded primary",to:{name:"recruiterCandidateDetail",params:{id:n.person.id}},title:"Ver Candidato",target:"_blank"},{default:g(()=>[r(p,{icon:"mdi:user"})]),_:2},1032,["to"])]),_:1},8,["items","columns","loading","total","loadMore","onOnLoadMore","onOnSearch"])]),o.openDropdownItem?(d(),c("article",{key:0,ref:"dropdown",style:A(o.dropdownStyles),class:"dropdown-status"},[s("ul",null,[(d(!0),c(I,null,v(o.aplicationStatus,n=>(d(),c("li",{key:n.id,onClick:h=>i.handleToggleStatus(o.openDropdownItem,n.value)},m(n.title),9,x))),128))])],4)):b("",!0)])}const q=V(B,[["render",E],["__scopeId","data-v-554ff39a"]]);export{q as default};
