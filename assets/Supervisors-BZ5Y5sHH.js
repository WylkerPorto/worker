import{M,D as b}from"./ModalBase-BjmfphOP.js";import{_ as S,h as w,w as m,e as a,f as v,r as l,b as n,g as F,o as g,I as _,t as I,c as D,F as B}from"./index-KK15FGoK.js";import{M as C,F as k,c as E,a as h}from"./MyButton-CUN_XA1s.js";const O={name:"FormSupervisorModal",components:{ModalBase:M,FormInput:k,MyButton:C},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onSave"],data(){return{form:{},errors:{},loading:!1}},watch:{dataForm(){this.form={...this.dataForm}}},methods:{validate(){E({name:h().required("Nome é obrigatório"),email:h().email("E-mail inválido").required("E-mail é obrigatório"),password:this.form.id?h().min(6,"Senha deve ter pelo menos 6 caracteres"):h().min(6,"Senha deve ter pelo menos 6 caracteres").required("Senha é obrigatória")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.saveSupervisor()}).catch(e=>{const d={};e.inner.forEach(u=>{d[u.path]=u.message}),this.errors=d})},async saveSupervisor(){this.loading=!0;try{await new Promise(r=>setTimeout(r,5e3)),console.log("saveSupervisor",this.form),this.$emit("onSave",this.form),this.$snotify.success("Supervisor salvo com sucesso!")}catch(r){this.$snotify.error("Erro ao salvar o supervisor: "+r)}finally{this.loading=!1}},closeModal(){this.form={},this.errors={},this.$emit("onClose")}}};function x(r,e,d,u,o,s){const i=l("FormInput"),c=l("MyButton"),p=l("ModalBase");return g(),w(p,{open:d.show,loading:o.loading,title:"Novo Supervisor",onOnClose:s.closeModal},{content:m(()=>[n("form",{onSubmit:e[3]||(e[3]=F((...t)=>s.validate&&s.validate(...t),["prevent"]))},[a(i,{label:"Nome",type:"text",placeholder:"Digite o nome",modelValue:o.form.name,"onUpdate:modelValue":e[0]||(e[0]=t=>o.form.name=t),error:o.errors.name,required:""},null,8,["modelValue","error"]),a(i,{label:"E-mail",type:"email",placeholder:"Digite o e-mail",modelValue:o.form.email,"onUpdate:modelValue":e[1]||(e[1]=t=>o.form.email=t),error:o.errors.email,required:""},null,8,["modelValue","error"]),a(i,{label:"Senha",type:"password",placeholder:"Digite a senha",modelValue:o.form.password,"onUpdate:modelValue":e[2]||(e[2]=t=>o.form.password=t),error:o.errors.password,required:""},null,8,["modelValue","error"])],32)]),actions:m(()=>[a(c,{class:"btn success",loading:o.loading,onClick:s.validate},{default:m(()=>e[4]||(e[4]=[v(" Salvar ")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading","onOnClose"])}const V=S(O,[["render",x],["__scopeId","data-v-8eb6472f"]]),N={name:"DeleteSupervisorModal",components:{ModalBase:M,Icon:_,MyButton:C},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onConfirm"],data(){return{loading:!1}},methods:{async deleteSupervisor(){this.loading=!0;try{await new Promise(r=>setTimeout(r,1e3)),this.$emit("onConfirm"),this.$snotify.success("Supervisor excluído com sucesso!")}catch(r){this.$snotify.error("Erro ao excluir o supervisor: "+r)}finally{this.loading=!1}}}};function T(r,e,d,u,o,s){const i=l("Icon"),c=l("MyButton"),p=l("ModalBase");return g(),w(p,{open:d.show,loading:o.loading,title:"Confirmar Exclusão",onOnClose:e[0]||(e[0]=t=>r.$emit("onClose"))},{content:m(()=>{var t;return[n("section",null,[a(i,{icon:"carbon:warning"}),n("div",null,[n("p",null,[e[1]||(e[1]=v(" Tem certeza que deseja excluir o surpevisor ")),n("span",null,I((t=d.dataForm)==null?void 0:t.name),1),e[2]||(e[2]=v(" ? "))]),e[3]||(e[3]=n("p",null,"Essa ação não pode ser desfeita!",-1))])])]}),actions:m(()=>[a(c,{class:"btn danger",loading:o.loading,onClick:s.deleteSupervisor},{default:m(()=>e[4]||(e[4]=[v("Confirmar")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading"])}const q=S(N,[["render",T],["__scopeId","data-v-34263995"]]),A={name:"SupervisorController",components:{DataTable:b,Icon:_,FormSupervisorModal:V,DeleteSupervisorModal:q},data(){return{showDeleteSupervisorModal:!1,showFormSupervisorModal:!1,loading:!1,columns:[{key:"name",title:"Nome"},{key:"email",title:"Email"},{key:"created",title:"Criado em"}],items:[],editItem:{}}},mounted(){this.getSupervisors()},methods:{async getSupervisors(){this.closeAllModals(),this.loading=!0;try{await new Promise(r=>setTimeout(r,1e3)),this.items=[{id:1,name:"João",email:"BZb3P@example.com",created:"2022-01-01"}]}catch(r){this.$snotify.error("Erro ao buscar os recrutadores: "+r)}finally{this.loading=!1}},handleSearch(r){console.log(r)},handleNewSupervisor(){this.editItem={},this.showFormSupervisorModal=!0},handleEditSupervisor(r){this.editItem=r,this.showFormSupervisorModal=!0},handleConfirmDelete(r){this.editItem=r,this.showDeleteSupervisorModal=!0},closeAllModals(){this.editItem={},this.showFormSupervisorModal=!1,this.showDeleteSupervisorModal=!1}}},P={class:"card"},j=["onClick"],U=["onClick"];function z(r,e,d,u,o,s){const i=l("Icon"),c=l("DataTable"),p=l("FormSupervisorModal"),t=l("DeleteSupervisorModal");return g(),D(B,null,[n("main",null,[n("section",P,[n("header",null,[e[1]||(e[1]=n("h1",null,"Supervisores",-1)),n("button",{class:"rounded",onClick:e[0]||(e[0]=f=>o.showFormSupervisorModal=!0)},[a(i,{icon:"tdesign:user-add"})])]),a(c,{items:o.items,columns:o.columns,loading:o.loading,total:1,onOnSearch:s.handleSearch},{actions:m(({item:f})=>[n("button",{class:"rounded success",onClick:y=>s.handleEditSupervisor(f)},[a(i,{icon:"carbon:edit"})],8,j),n("button",{class:"rounded danger",onClick:y=>s.handleConfirmDelete(f)},[a(i,{icon:"carbon:trash-can"})],8,U)]),_:1},8,["items","columns","loading","onOnSearch"])])]),a(p,{show:o.showFormSupervisorModal,dataForm:o.editItem,onOnClose:s.closeAllModals,onOnSave:s.getSupervisors},null,8,["show","dataForm","onOnClose","onOnSave"]),a(t,{show:o.showDeleteSupervisorModal,dataForm:o.editItem,onOnClose:s.closeAllModals,onOnConfirm:s.getSupervisors},null,8,["show","dataForm","onOnClose","onOnConfirm"])],64)}const H=S(A,[["render",z],["__scopeId","data-v-109a9d83"]]);export{H as default};
