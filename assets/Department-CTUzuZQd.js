import{D as b}from"./DataTable-BlcHQmC8.js";import{_ as y,g as C,w as d,e as n,f as D,r,a as s,h as I,o as p,I as M,t as k,c as _,F as S}from"./index-BLcxalff.js";import{F as B,c as O,a as E}from"./FormInput-C5ftnFIk.js";import{M as w}from"./ModalBase-s2-wMfuw.js";import{M as v}from"./MyButton-DrcBuMc_.js";import{u as F,c as x,r as A,l as T}from"./department-Do0307RN.js";import"./SearchInput-Ba4cr6qp.js";import"./conversors-a5ARN5za.js";import"./http-BgvyJrsg.js";const N={name:"FormDepartmentModal",components:{ModalBase:w,FormInput:B,MyButton:v},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onSave"],data(){return{form:{status:!1},errors:{},loading:!1}},watch:{dataForm(){this.dataForm&&(this.form={...this.form,...this.dataForm})}},methods:{validate(){O({name:E().required("Setor é obrigatório")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.saveDepartment()}).catch(t=>{const i={};t.inner.forEach(u=>{i[u.path]=u.message}),this.errors=i})},async saveDepartment(){this.loading=!0;try{const e=!!this.form.id;e?(delete this.form.id,delete this.form.createdAt,delete this.form.updatedAt,delete this.form.deletedAt,await F(this.dataForm.id,this.form)):await x(this.form),this.$snotify.success(`Setor ${e?"atualizado":"criado"} com sucesso`),this.$emit("onSave"),this.closeModal()}catch(e){this.$snotify.error("Erro ao salvar o setor: "+e)}finally{this.loading=!1}},closeModal(){this.form={status:!1},this.errors={},this.$emit("onClose")}}};function V(e,t,i,u,o,a){const l=r("FormInput"),h=r("MyButton"),f=r("ModalBase");return p(),C(f,{open:i.show,loading:o.loading,title:"Novo Setor",onOnClose:a.closeModal},{content:d(()=>[s("form",{onSubmit:t[1]||(t[1]=I((...m)=>a.validate&&a.validate(...m),["prevent"]))},[n(l,{label:"Setor",type:"text",placeholder:"Digite o setor",modelValue:o.form.name,"onUpdate:modelValue":t[0]||(t[0]=m=>o.form.name=m),error:o.errors.name,required:""},null,8,["modelValue","error"])],32)]),actions:d(()=>[n(h,{class:"btn success",loading:o.loading,onClick:a.validate},{default:d(()=>t[2]||(t[2]=[D(" Salvar ")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading","onOnClose"])}const q=y(N,[["render",V],["__scopeId","data-v-bba34f1c"]]),z={name:"DeleteDepartmentModal",components:{ModalBase:w,Icon:M,MyButton:v},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onConfirm"],data(){return{loading:!1}},methods:{async deleteDepartment(){this.loading=!0;try{await A(this.dataForm.id),this.$snotify.success("Setor excluído com sucesso!"),this.$emit("onConfirm"),this.$emit("onClose")}catch(e){this.$snotify.error("Erro ao excluir o setor: "+e)}finally{this.loading=!1}}}};function $(e,t,i,u,o,a){const l=r("Icon"),h=r("MyButton"),f=r("ModalBase");return p(),C(f,{open:i.show,loading:o.loading,title:"Confirmar Exclusão",onOnClose:t[0]||(t[0]=m=>e.$emit("onClose"))},{content:d(()=>[s("section",null,[n(l,{icon:"carbon:warning"}),s("div",null,[s("p",null,[t[1]||(t[1]=D(" Tem certeza que deseja excluir o setor ")),s("span",null,k(i.dataForm?.name),1),t[2]||(t[2]=D(" ? "))]),t[3]||(t[3]=s("p",null,"Essa ação não pode ser desfeita!",-1))])])]),actions:d(()=>[n(h,{class:"btn danger",loading:o.loading,onClick:a.deleteDepartment},{default:d(()=>t[4]||(t[4]=[D("Confirmar")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading"])}const j=y(z,[["render",$],["__scopeId","data-v-fa4fd001"]]),L={name:"RecruiterDepartment",components:{DataTable:b,Icon:M,FormDepartmentModal:q,DeleteDepartmentModal:j},data(){return{showFormDepartmentModal:!1,showDeleteDepartmentModal:!1,loading:!1,columns:[{key:"name",title:"Nome"},{key:"status",title:"Status",type:"boolean"},{key:"createdAt",title:"Criado em",type:"date"}],items:[],editItem:{},total:0,search:""}},mounted(){this.getDepartments()},methods:{refresh(){this.items=[],this.getDepartments()},async getDepartments(){this.closeAllModals(),this.loading=!0;try{const{data:e}=await T(this.filters);this.items=e,this.total=e.length}catch(e){this.$snotify.error("Erro ao buscar os setor: "+e)}finally{this.loading=!1}},async handleToggleDepartment(e){this.loading=!0;try{e.status=!e.status,await F(e.id,{status:e.status}),this.$snotify.success("Setor atualizado com sucesso!")}catch(t){this.$snotify.error("Erro ao atualizar o setor: "+t),e.status=!e.status}finally{this.loading=!1}},handleSearch(e){this.search=e},handleNewDepartment(){this.editItem={},this.showFormDepartmentModal=!0},handleEditDepartment(e){this.editItem=e,this.showFormDepartmentModal=!0},handleConfirmDelete(e){this.editItem=e,this.showDeleteDepartmentModal=!0},closeAllModals(){this.editItem={},this.showFormDepartmentModal=!1,this.showDeleteDepartmentModal=!1}},computed:{filteredItems(){return this.items.filter(e=>e.name.toLowerCase().includes(this.search.toLowerCase()))}}},P={class:"card"},R=["onClick"],U=["onClick"],G=["onClick"],H=["onClick"];function J(e,t,i,u,o,a){const l=r("Icon"),h=r("DataTable"),f=r("FormDepartmentModal"),m=r("DeleteDepartmentModal");return p(),_(S,null,[s("main",null,[s("section",P,[s("header",null,[t[1]||(t[1]=s("h1",null,"Setores",-1)),s("button",{class:"rounded",onClick:t[0]||(t[0]=c=>o.showFormDepartmentModal=!0),title:"Novo Setor"},[n(l,{icon:"qlementine-icons:new-16"})])]),n(h,{items:a.filteredItems,columns:o.columns,loading:o.loading,totalItems:o.total,onOnSearch:a.handleSearch},{actions:d(({item:c})=>[c.status?(p(),_("button",{key:0,class:"rounded warning",onClick:g=>a.handleToggleDepartment(c),title:"Pausar"},[n(l,{icon:"ic:round-pause"})],8,R)):(p(),_("button",{key:1,class:"rounded primary",onClick:g=>a.handleToggleDepartment(c),title:"Ativar"},[n(l,{icon:"ic:round-play-arrow"})],8,U)),s("button",{class:"rounded success",onClick:g=>a.handleEditDepartment(c)},[n(l,{icon:"carbon:edit"})],8,G),s("button",{class:"rounded danger",onClick:g=>a.handleConfirmDelete(c)},[n(l,{icon:"carbon:trash-can"})],8,H)]),_:1},8,["items","columns","loading","totalItems","onOnSearch"])])]),n(f,{show:o.showFormDepartmentModal,dataForm:o.editItem,onOnClose:a.closeAllModals,onOnSave:a.refresh},null,8,["show","dataForm","onOnClose","onOnSave"]),n(m,{show:o.showDeleteDepartmentModal,dataForm:o.editItem,onOnClose:a.closeAllModals,onOnConfirm:a.refresh},null,8,["show","dataForm","onOnClose","onOnConfirm"])],64)}const ae=y(L,[["render",J],["__scopeId","data-v-7dcd7498"]]);export{ae as default};
