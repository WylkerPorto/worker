import{F as V,c as w,a as c,h as E}from"./http-BiH2roC9.js";import{M as F}from"./MyButton-BsTqssDR.js";import{c as k}from"./user-CkI9ArkJ.js";import{_ as g,c as y,a,e as m,r as u,w as C,f as h,g as S,o as p,n as I,t as x,h as b,b as v}from"./index-BBCqJuXd.js";import"./moment-C5S46NFB.js";const A={name:"RegisterCard",components:{FormInput:V,MyButton:F},props:{dataForm:{type:Object}},data(){return{form:{},localForm:this.dataForm,errors:{},loading:!1}},methods:{validate(){w({name:c().min(3,"Nome deve ter pelo menos 3 caracteres").required("Nome é obrigatório"),email:c().email("E-mail inválido").required("E-mail é obrigatório"),password:c().min(6,"Senha deve ter pelo menos 6 caracteres").required("Senha é obrigatória"),phoneNumber:c().matches(/^\(\d{2}\)\s\d{4,5}-\d{4}$/,"Telefone deve estar no formato (12) 12345-1234").required("Telefone é obrigatório")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.registerAccount()}).catch(e=>{const s={};e.inner.forEach(n=>{s[n.path]=n.message}),this.errors=s})},async registerAccount(){this.loading=!0;try{await k(this.form)}catch(o){this.$snotify.error("Erro ao cadastrar: "+o.message)}finally{this.loading=!1}}}};function B(o,e,s,n,r,i){const l=u("FormInput"),f=u("MyButton");return p(),y("form",{class:"card",onSubmit:e[5]||(e[5]=S((...t)=>i.validate&&i.validate(...t),["stop","prevent"]))},[e[8]||(e[8]=a("h2",null,"Criar conta",-1)),m(l,{label:"Nome",modelValue:r.form.name,"onUpdate:modelValue":e[0]||(e[0]=t=>r.form.name=t),error:r.errors.name,type:"text",placeholder:"Digite seu nome"},null,8,["modelValue","error"]),m(l,{label:"E-mail",modelValue:r.form.email,"onUpdate:modelValue":e[1]||(e[1]=t=>r.form.email=t),error:r.errors.email,type:"email",placeholder:"Digite seu e-mail"},null,8,["modelValue","error"]),m(l,{label:"Senha",modelValue:r.form.password,"onUpdate:modelValue":e[2]||(e[2]=t=>r.form.password=t),error:r.errors.password,type:"password",placeholder:"Digite sua senha"},null,8,["modelValue","error"]),m(l,{label:"Telefone",modelValue:r.form.phoneNumber,"onUpdate:modelValue":e[3]||(e[3]=t=>r.form.phoneNumber=t),error:r.errors.phoneNumber,type:"tel",placeholder:"(99) 99999-9999",mask:"tel"},null,8,["modelValue","error"]),m(f,{class:"primary",loading:r.loading},{default:C(()=>e[6]||(e[6]=[h("Cadastrar")])),_:1},8,["loading"]),e[9]||(e[9]=a("hr",null,null,-1)),a("span",null,[e[7]||(e[7]=h(" Já é cadastrado? ")),a("a",{href:"#",onClick:e[4]||(e[4]=t=>r.localForm.type="login")},"Entrar")])],32)}const D=g(A,[["render",B],["__scopeId","data-v-b6fbe0f6"]]),_={name:"SwitchButton",props:{modelValue:{type:Boolean,required:!0}},emits:["update:modelValue"],methods:{toggle(){this.$emit("update:modelValue",!this.modelValue)}}};function M(o,e,s,n,r,i){return p(),y("div",{class:I(["switch",{"switch--checked":s.modelValue}]),onClick:e[0]||(e[0]=(...l)=>i.toggle&&i.toggle(...l))},e[1]||(e[1]=[a("div",{class:"switch__track"},null,-1),a("div",{class:"switch__thumb"},null,-1)]),2)}const R=g(_,[["render",M],["__scopeId","data-v-9b193d93"]]),N=o=>E.api().post("/auth/login",o),q=o=>E.api().post("/auth/login-candidate",o),U=o=>E.api().post("/login/remember",o),L={name:"LoginCard",components:{FormInput:V,MyButton:F,MySwitch:R},props:{dataForm:{type:Object}},data(){return{form:{},localForm:this.dataForm,errors:{},loading:!1,admin:!1}},methods:{validate(){w({email:c().email("E-mail inválido").required("E-mail é obrigatório"),password:c().min(6,"Senha deve ter pelo menos 6 caracteres").required("Senha é obrigatória")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.loginAccount()}).catch(e=>{const s={};e.inner.forEach(n=>{s[n.path]=n.message}),this.errors=s})},async loginAccount(){this.loading=!0;try{const o=await(this.admin?N(this.form):q(this.form));this.setAuth(o.data.access_token,o.data.permission,o.data.uid)}catch(o){o.response.status===401?this.$snotify.error("E-mail ou senha inválidos"):o.response.status===403?this.$snotify.error("Acesso negado"):this.$snotify.error("Erro ao logar: "+o.message)}finally{this.loading=!1}},setAuth(o,e,s){localStorage.setItem("login","true"),localStorage.setItem("token",o),localStorage.setItem("role",e),localStorage.setItem("uid",s.toString()),this.sendToDashboard(e)},sendToDashboard(o){switch(o){case 1:this.$router.push({name:"adminDashboard"});return;case 2:this.$router.push({name:"supervisorDashboard"});return;case 3:this.$router.push({name:"recruiterDashboard"});return;case 4:this.$router.push({name:"userDashboard"});return;default:this.$snotify.error("Erro ao logar: Regra invalida");return}}}},T={class:"flex"};function j(o,e,s,n,r,i){const l=u("FormInput"),f=u("MySwitch"),t=u("MyButton");return p(),y("form",{class:"card",onSubmit:e[6]||(e[6]=S((...d)=>i.validate&&i.validate(...d),["stop","prevent"]))},[e[9]||(e[9]=a("h2",null,"Login",-1)),m(l,{label:"E-mail",modelValue:r.form.email,"onUpdate:modelValue":e[0]||(e[0]=d=>r.form.email=d),error:r.errors.email,type:"email",placeholder:"Digite seu e-mail"},null,8,["modelValue","error"]),m(l,{label:"Senha",modelValue:r.form.password,"onUpdate:modelValue":e[1]||(e[1]=d=>r.form.password=d),error:r.errors.password,type:"password",placeholder:"Digite sua senha"},null,8,["modelValue","error"]),a("div",T,[m(f,{modelValue:r.admin,"onUpdate:modelValue":e[2]||(e[2]=d=>r.admin=d)},null,8,["modelValue"]),a("span",{onClick:e[3]||(e[3]=d=>r.admin=!r.admin)},x(r.admin?"Recrutador":"Candidato"),1)]),a("a",{href:"#",onClick:e[4]||(e[4]=d=>r.localForm.type="forgot-password")},"Esqueci minha senha"),m(t,{class:"primary",loading:r.loading},{default:C(()=>e[7]||(e[7]=[h("Entrar")])),_:1},8,["loading"]),e[10]||(e[10]=a("hr",null,null,-1)),a("span",null,[e[8]||(e[8]=h(" Ainda não tem conta? ")),a("a",{href:"#",onClick:e[5]||(e[5]=d=>r.localForm.type="register")},"Cadastre-se")])],32)}const O=g(L,[["render",j],["__scopeId","data-v-deefc206"]]),z={name:"RememberCard",components:{FormInput:V,MyButton:F},props:{dataForm:{type:Object}},data(){return{form:{},localForm:this.dataForm,errors:{},loading:!1}},methods:{validate(){w({email:c().email("E-mail inválido").required("E-mail é obrigatório")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.rememberAccount()}).catch(e=>{const s={};e.inner.forEach(n=>{s[n.path]=n.message}),this.errors=s})},async rememberAccount(){this.loading=!0;try{await U(this.form)}catch(o){this.$snotify.error("Erro ao recuperar senha: "+o.message)}finally{this.loading=!1}}}};function J(o,e,s,n,r,i){const l=u("FormInput"),f=u("MyButton");return p(),y("form",{class:"card",onSubmit:e[2]||(e[2]=S((...t)=>i.validate&&i.validate(...t),["stop","prevent"]))},[e[5]||(e[5]=a("h2",null,"Recuperar Senha",-1)),m(l,{label:"E-mail",modelValue:r.form.email,"onUpdate:modelValue":e[0]||(e[0]=t=>r.form.email=t),error:r.errors.email,type:"email",placeholder:"Digite seu e-mail"},null,8,["modelValue","error"]),m(f,{class:"primary",loading:r.loading},{default:C(()=>e[3]||(e[3]=[h("Recuperar")])),_:1},8,["loading"]),e[6]||(e[6]=a("hr",null,null,-1)),a("span",null,[e[4]||(e[4]=h(" Lembrou sua senha? ")),a("a",{href:"#",onClick:e[1]||(e[1]=t=>r.localForm.type="login")},"Entrar")])],32)}const G=g(z,[["render",J],["__scopeId","data-v-89f38caf"]]),H={name:"LoginView",components:{LoginCard:O,RegisterCard:D,RememberCard:G},data(){return{form:{type:"login"}}},methods:{}};function K(o,e,s,n,r,i){const l=u("LoginCard"),f=u("RegisterCard"),t=u("RememberCard");return p(),y("main",null,[r.form.type==="login"?(p(),b(l,{key:0,dataForm:r.form},null,8,["dataForm"])):v("",!0),r.form.type==="register"?(p(),b(f,{key:1,dataForm:r.form},null,8,["dataForm"])):v("",!0),r.form.type==="forgot-password"?(p(),b(t,{key:2,dataForm:r.form},null,8,["dataForm"])):v("",!0)])}const Z=g(H,[["render",K],["__scopeId","data-v-61a27157"]]);export{Z as default};
