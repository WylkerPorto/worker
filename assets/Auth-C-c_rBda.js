import{h as v,M as E,F,c as V,a as f}from"./http-_xJ5E_GF.js";import{_ as g,c as h,a,e as m,r as u,w as C,f as c,g as w,o as p,h as y,b}from"./index-C0qFCwY_.js";const I=o=>v.api().post("/auth/login",o),S=o=>v.api().post("/login/remember",o),R=o=>v.api().post("/register",o),k={name:"RegisterCard",components:{FormInput:F,MyButton:E},props:{dataForm:{type:Object}},data(){return{form:{},localForm:this.dataForm,errors:{},loading:!1}},methods:{validate(){V({name:f().min(3,"Nome deve ter pelo menos 3 caracteres").required("Nome é obrigatório"),email:f().email("E-mail inválido").required("E-mail é obrigatório"),password:f().min(6,"Senha deve ter pelo menos 6 caracteres").required("Senha é obrigatória")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.registerAccount()}).catch(e=>{const s={};e.inner.forEach(n=>{s[n.path]=n.message}),this.errors=s})},async registerAccount(){this.loading=!0;try{await R(this.form)}catch(o){this.$snotify.error("Erro ao cadastrar: "+o.message)}finally{this.loading=!1}}}};function x(o,e,s,n,r,i){const l=u("FormInput"),d=u("MyButton");return p(),h("form",{class:"card",onSubmit:e[4]||(e[4]=w((...t)=>i.validate&&i.validate(...t),["stop","prevent"]))},[e[7]||(e[7]=a("h2",null,"Criar conta",-1)),m(l,{label:"Nome",modelValue:r.form.name,"onUpdate:modelValue":e[0]||(e[0]=t=>r.form.name=t),error:r.errors.name,type:"text",placeholder:"Digite seu nome"},null,8,["modelValue","error"]),m(l,{label:"E-mail",modelValue:r.form.email,"onUpdate:modelValue":e[1]||(e[1]=t=>r.form.email=t),error:r.errors.email,type:"email",placeholder:"Digite seu e-mail"},null,8,["modelValue","error"]),m(l,{label:"Senha",modelValue:r.form.password,"onUpdate:modelValue":e[2]||(e[2]=t=>r.form.password=t),error:r.errors.password,type:"password",placeholder:"Digite sua senha"},null,8,["modelValue","error"]),m(d,{class:"primary",loading:r.loading},{default:C(()=>e[5]||(e[5]=[c("Cadastrar")])),_:1},8,["loading"]),e[8]||(e[8]=a("hr",null,null,-1)),a("span",null,[e[6]||(e[6]=c(" Já é cadastrado? ")),a("a",{href:"#",onClick:e[3]||(e[3]=t=>r.localForm.type="login")},"Entrar")])],32)}const A=g(k,[["render",x],["__scopeId","data-v-10224887"]]),B={name:"LoginCard",components:{FormInput:F,MyButton:E},props:{dataForm:{type:Object}},data(){return{form:{},localForm:this.dataForm,errors:{},loading:!1}},methods:{validate(){V({email:f().email("E-mail inválido").required("E-mail é obrigatório"),password:f().min(6,"Senha deve ter pelo menos 6 caracteres").required("Senha é obrigatória")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.loginAccount()}).catch(e=>{const s={};e.inner.forEach(n=>{s[n.path]=n.message}),this.errors=s})},async loginAccount(){this.loading=!0;try{const o=await I(this.form);this.setAuth(o.data.access_token,o.data.permission)}catch(o){o.response.status===401?this.$snotify.error("E-mail ou senha inválidos"):o.response.status===403?this.$snotify.error("Acesso negado"):this.$snotify.error("Erro ao logar: "+o.message)}finally{this.loading=!1}},setAuth(o,e){localStorage.setItem("login","true"),localStorage.setItem("token",o),localStorage.setItem("role",this.getRole(e)),localStorage.getItem("role")==="admin"?this.$router.push({name:"adminDashboard"}):localStorage.getItem("role")==="user"?this.$router.push({name:"userDashboard"}):localStorage.getItem("role")==="supervisor"?this.$router.push({name:"supervisorDashboard"}):localStorage.getItem("role")==="recruiter"?this.$router.push({name:"recruiterDashboard"}):this.$snotify.error("Erro ao logar: Regra invalida")},getRole(o){switch(o){case 1:return"admin";case 2:return"supervisor";case 3:return"recruiter";case 4:return"user";default:return""}}}};function D(o,e,s,n,r,i){const l=u("FormInput"),d=u("MyButton");return p(),h("form",{class:"card",onSubmit:e[4]||(e[4]=w((...t)=>i.validate&&i.validate(...t),["stop","prevent"]))},[e[7]||(e[7]=a("h2",null,"Login",-1)),m(l,{label:"E-mail",modelValue:r.form.email,"onUpdate:modelValue":e[0]||(e[0]=t=>r.form.email=t),error:r.errors.email,type:"email",placeholder:"Digite seu e-mail"},null,8,["modelValue","error"]),m(l,{label:"Senha",modelValue:r.form.password,"onUpdate:modelValue":e[1]||(e[1]=t=>r.form.password=t),error:r.errors.password,type:"password",placeholder:"Digite sua senha"},null,8,["modelValue","error"]),a("a",{href:"#",onClick:e[2]||(e[2]=t=>r.localForm.type="forgot-password")},"Esqueci minha senha"),m(d,{class:"primary",loading:r.loading},{default:C(()=>e[5]||(e[5]=[c("Entrar")])),_:1},8,["loading"]),e[8]||(e[8]=a("hr",null,null,-1)),a("span",null,[e[6]||(e[6]=c(" Ainda não tem conta? ")),a("a",{href:"#",onClick:e[3]||(e[3]=t=>r.localForm.type="register")},"Cadastre-se")])],32)}const M=g(B,[["render",D],["__scopeId","data-v-0a01de2a"]]),q={name:"RememberCard",components:{FormInput:F,MyButton:E},props:{dataForm:{type:Object}},data(){return{form:{},localForm:this.dataForm,errors:{},loading:!1}},methods:{validate(){V({email:f().email("E-mail inválido").required("E-mail é obrigatório")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.rememberAccount()}).catch(e=>{const s={};e.inner.forEach(n=>{s[n.path]=n.message}),this.errors=s})},async rememberAccount(){this.loading=!0;try{await S(this.form)}catch(o){this.$snotify.error("Erro ao recuperar senha: "+o.message)}finally{this.loading=!1}}}};function L(o,e,s,n,r,i){const l=u("FormInput"),d=u("MyButton");return p(),h("form",{class:"card",onSubmit:e[2]||(e[2]=w((...t)=>i.validate&&i.validate(...t),["stop","prevent"]))},[e[5]||(e[5]=a("h2",null,"Recuperar Senha",-1)),m(l,{label:"E-mail",modelValue:r.form.email,"onUpdate:modelValue":e[0]||(e[0]=t=>r.form.email=t),error:r.errors.email,type:"email",placeholder:"Digite seu e-mail"},null,8,["modelValue","error"]),m(d,{class:"primary",loading:r.loading},{default:C(()=>e[3]||(e[3]=[c("Recuperar")])),_:1},8,["loading"]),e[6]||(e[6]=a("hr",null,null,-1)),a("span",null,[e[4]||(e[4]=c(" Lembrou sua senha? ")),a("a",{href:"#",onClick:e[1]||(e[1]=t=>r.localForm.type="login")},"Entrar")])],32)}const N=g(q,[["render",L],["__scopeId","data-v-89f38caf"]]),_={name:"LoginView",components:{LoginCard:M,RegisterCard:A,RememberCard:N},data(){return{form:{type:"login"}}},methods:{}};function U(o,e,s,n,r,i){const l=u("LoginCard"),d=u("RegisterCard"),t=u("RememberCard");return p(),h("main",null,[r.form.type==="login"?(p(),y(l,{key:0,dataForm:r.form},null,8,["dataForm"])):b("",!0),r.form.type==="register"?(p(),y(d,{key:1,dataForm:r.form},null,8,["dataForm"])):b("",!0),r.form.type==="forgot-password"?(p(),y(t,{key:2,dataForm:r.form},null,8,["dataForm"])):b("",!0)])}const J=g(_,[["render",U],["__scopeId","data-v-61a27157"]]);export{J as default};
