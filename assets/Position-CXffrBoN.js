import{D as b}from"./DataTable-CnAYPmaw.js";import{_ as y,g as M,w as d,e as a,f as p,r as i,a as n,h as I,o as g,I as w,t as k,c as _,F as B}from"./index-CE6mVOuz.js";import{F as D,c as O,a as E}from"./FormInput-IrOfyq7R.js";import{M as P}from"./ModalBase-BkrVPSgU.js";import{M as v}from"./MyButton-BnYoF38R.js";import{u as F,c as x,r as S,l as A}from"./position-DbCYT6eu.js";import"./SearchInput-B0ahrWZm.js";import"./conversors-Cr9q1EG2.js";import"./http-Bhklev2d.js";const T={name:"FormPositionModal",components:{ModalBase:P,FormInput:D,MyButton:v},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onSave"],data(){return{form:{status:!0},errors:{},loading:!1}},watch:{dataForm(){this.dataForm&&(this.form={...this.form,...this.dataForm})}},methods:{validate(){O({name:E().required("Cargo é obrigatório")}).validate(this.form,{abortEarly:!1}).then(()=>{this.errors={},this.savePosition()}).catch(t=>{const l={};t.inner.forEach(u=>{l[u.path]=u.message}),this.errors=l})},async savePosition(){this.loading=!0;try{const o=!!this.form.id;o&&(delete this.form.id,delete this.form.createdAt,delete this.form.updatedAt,delete this.form.deletedAt),o?await F(this.dataForm.id,this.form):await x(this.form),this.$snotify.success(`Cargo ${o?"atualizado":"criado"} com sucesso`),this.$emit("onSave"),this.closeModal()}catch(o){this.$snotify.error("Erro ao salvar o cargo: "+o)}finally{this.loading=!1}},closeModal(){this.form={status:!0},this.errors={},this.$emit("onClose")}}};function N(o,t,l,u,e,s){const r=i("FormInput"),h=i("MyButton"),f=i("ModalBase");return g(),M(f,{open:l.show,loading:e.loading,title:"Novo Cargo",onOnClose:s.closeModal},{content:d(()=>[n("form",{onSubmit:t[1]||(t[1]=I((...c)=>s.validate&&s.validate(...c),["prevent"]))},[a(r,{label:"Cargo",type:"text",placeholder:"Digite o cargo",modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=c=>e.form.name=c),error:e.errors.name,required:""},null,8,["modelValue","error"])],32)]),actions:d(()=>[a(h,{class:"btn success",loading:e.loading,onClick:s.validate},{default:d(()=>t[2]||(t[2]=[p(" Salvar ")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading","onOnClose"])}const V=y(T,[["render",N],["__scopeId","data-v-477d14c1"]]),q={name:"DeletePositionModal",components:{ModalBase:P,Icon:w,MyButton:v},props:{show:{type:Boolean,default:!1},dataForm:{type:Object}},emits:["onClose","onConfirm"],data(){return{loading:!1}},methods:{async deletePosition(){this.loading=!0;try{await S(this.dataForm.id),this.$snotify.success("Cargo excluído com sucesso!"),this.$emit("onConfirm"),this.$emit("onClose")}catch(o){this.$snotify.error("Erro ao excluir o cargo: "+o)}finally{this.loading=!1}}}};function z(o,t,l,u,e,s){const r=i("Icon"),h=i("MyButton"),f=i("ModalBase");return g(),M(f,{open:l.show,loading:e.loading,title:"Confirmar Exclusão",onOnClose:t[0]||(t[0]=c=>o.$emit("onClose"))},{content:d(()=>[n("section",null,[a(r,{icon:"carbon:warning"}),n("div",null,[n("p",null,[t[1]||(t[1]=p(" Tem certeza que deseja excluir o cargo ")),n("span",null,k(l.dataForm?.name),1),t[2]||(t[2]=p(" ? "))]),t[3]||(t[3]=n("p",null,"Essa ação não pode ser desfeita!",-1))])])]),actions:d(()=>[a(h,{class:"btn danger",loading:e.loading,onClick:s.deletePosition},{default:d(()=>t[4]||(t[4]=[p("Confirmar")])),_:1},8,["loading","onClick"])]),_:1},8,["open","loading"])}const $=y(q,[["render",z],["__scopeId","data-v-5b13b7af"]]),j={name:"RecruiterPosition",components:{DataTable:b,Icon:w,FormPositionModal:V,DeletePositionModal:$},data(){return{showFormPositionModal:!1,showDeletePositionModal:!1,loading:!1,columns:[{key:"name",title:"Nome"},{key:"status",title:"Status",type:"boolean"},{key:"createdAt",title:"Criado em",type:"date"}],items:[],editItem:{},total:0,search:""}},mounted(){this.getPositions()},methods:{refresh(){this.items=[],this.getPositions()},async getPositions(){this.closeAllModals(),this.loading=!0;try{const{data:o}=await A();this.items=o,this.total=o.length}catch(o){this.$snotify.error("Erro ao buscar os cargos: "+o)}finally{this.loading=!1}},async handleTogglePosition(o){this.loading=!0;try{o.status=!o.status,await F(o.id,{status:o.status}),this.$snotify.success("Cargo atualizado com sucesso!")}catch(t){this.$snotify.error("Erro ao atualizar o cargo: "+t),o.status=!o.status}finally{this.loading=!1}},handleSearch(o){this.search=o},handleNewPosition(){this.editItem={},this.showFormPositionModal=!0},handleEditPosition(o){this.editItem=o,this.showFormPositionModal=!0},handleConfirmDelete(o){this.editItem=o,this.showDeletePositionModal=!0},closeAllModals(){this.editItem={},this.showFormPositionModal=!1,this.showDeletePositionModal=!1}},computed:{filteredItems(){return this.items.filter(o=>o.name.toLowerCase().includes(this.search.toLowerCase()))}}},L={class:"card"},R=["onClick"],U=["onClick"],G=["onClick"],H=["onClick"];function J(o,t,l,u,e,s){const r=i("Icon"),h=i("DataTable"),f=i("FormPositionModal"),c=i("DeletePositionModal");return g(),_(B,null,[n("main",null,[n("section",L,[n("header",null,[t[1]||(t[1]=n("h1",null,"Cargos",-1)),n("button",{class:"rounded",onClick:t[0]||(t[0]=m=>e.showFormPositionModal=!0),title:"Novo Cargo"},[a(r,{icon:"qlementine-icons:new-16"})])]),a(h,{items:s.filteredItems,columns:e.columns,loading:e.loading,totalItems:e.total,onOnSearch:s.handleSearch},{actions:d(({item:m})=>[m.status?(g(),_("button",{key:0,class:"rounded warning",onClick:C=>s.handleTogglePosition(m),title:"Pausar"},[a(r,{icon:"ic:round-pause"})],8,R)):(g(),_("button",{key:1,class:"rounded primary",onClick:C=>s.handleTogglePosition(m),title:"Ativar"},[a(r,{icon:"ic:round-play-arrow"})],8,U)),n("button",{class:"rounded success",onClick:C=>s.handleEditPosition(m)},[a(r,{icon:"carbon:edit"})],8,G),n("button",{class:"rounded danger",onClick:C=>s.handleConfirmDelete(m)},[a(r,{icon:"carbon:trash-can"})],8,H)]),_:1},8,["items","columns","loading","totalItems","onOnSearch"])])]),a(f,{show:e.showFormPositionModal,dataForm:e.editItem,onOnClose:s.closeAllModals,onOnSave:s.refresh},null,8,["show","dataForm","onOnClose","onOnSave"]),a(c,{show:e.showDeletePositionModal,dataForm:e.editItem,onOnClose:s.closeAllModals,onOnConfirm:s.refresh},null,8,["show","dataForm","onOnClose","onOnConfirm"])],64)}const so=y(j,[["render",J],["__scopeId","data-v-f7353ab2"]]);export{so as default};
